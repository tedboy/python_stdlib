

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>shelve &mdash; Python Standard Library</title>
  

  
  
    <link rel="shortcut icon" href="../_static/py.png"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Python Standard Library" href="../index.html"/>
        <link rel="up" title="API: 11 - 15" href="../api_11to15.html"/>
        <link rel="next" title="shelve.BsdDbShelf" href="generated/shelve.BsdDbShelf.html"/>
        <link rel="prev" title="copy_reg" href="copy_reg.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Python Standard Library
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../01to10.html">Ch 01 - 10</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11to20.html">Ch 11 - 20</a></li>
<li class="toctree-l1"><a class="reference internal" href="../21to30.html">Ch 21 - 30</a></li>
<li class="toctree-l1"><a class="reference internal" href="../31to37.html">Ch 31 - 37</a></li>
</ul>
<p class="caption"><span class="caption-text">Autogenerated API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api_06to10.html">API: 06 - 10</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_11to15.html">API: 11 - 15</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_16to20.html">API: 16 - 20</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_21to25.html">API: 21 - 25</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_26to30.html">API: 26 - 30</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_31to37.html">API: 31 - 37</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Python Standard Library</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          













<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../api_11to15.html">API: 11 - 15</a> &raquo;</li>
        
      <li><code class="docutils literal"><span class="pre">shelve</span></code></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/generated/shelve.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-shelve">
<span id="shelve"></span><h1><a class="reference internal" href="#module-shelve" title="shelve"><code class="xref py py-mod docutils literal"><span class="pre">shelve</span></code></a><a class="headerlink" href="#module-shelve" title="Permalink to this headline">¶</a></h1>
<p>Manage shelves of pickled objects.</p>
<p>A &#8220;shelf&#8221; is a persistent, dictionary-like object.  The difference
with dbm databases is that the values (not the keys!) in a shelf can
be essentially arbitrary Python objects &#8211; anything that the &#8220;pickle&#8221;
module can handle.  This includes most class instances, recursive data
types, and objects containing lots of shared sub-objects.  The keys
are ordinary strings.</p>
<p>To summarize the interface (key is a string, data is an arbitrary
object):</p>
<blockquote>
<div><p>import shelve
d = shelve.open(filename) # open, with (g)dbm filename &#8211; no suffix</p>
<dl class="docutils">
<dt>d[key] = data   # store data at key (overwrites old data if</dt>
<dd># using an existing key)</dd>
<dt>data = d[key]   # retrieve a COPY of the data at key (raise</dt>
<dd># KeyError if no such key) &#8211; NOTE that this
# access returns a <em>copy</em> of the entry!</dd>
<dt>del d[key]      # delete data stored at key (raises KeyError</dt>
<dd># if no such key)</dd>
</dl>
<p>flag = d.has_key(key)   # true if the key exists; same as &#8220;key in d&#8221;
list = d.keys() # a list of all existing keys (slow!)</p>
<p>d.close()       # close it</p>
</div></blockquote>
<p>Dependent on the implementation, closing a persistent dictionary may
or may not be necessary to flush changes to disk.</p>
<p>Normally, d[key] returns a COPY of the entry.  This needs care when
mutable entries are mutated: for example, if d[key] is a list,</p>
<blockquote>
<div>d[key].append(anitem)</div></blockquote>
<p>does NOT modify the entry d[key] itself, as stored in the persistent
mapping &#8211; it only modifies the copy, which is then immediately
discarded, so that the append has NO effect whatsoever.  To append an
item to d[key] in a way that will affect the persistent mapping, use:</p>
<blockquote>
<div>data = d[key]
data.append(anitem)
d[key] = data</div></blockquote>
<p>To avoid the problem with mutable entries, you may pass the keyword
argument writeback=True in the call to shelve.open.  When you use:</p>
<blockquote>
<div>d = shelve.open(filename, writeback=True)</div></blockquote>
<p>then d keeps a cache of all entries you access, and writes them all back
to the persistent mapping when you call d.close().  This ensures that
such usage as d[key].append(anitem) works as intended.</p>
<p>However, using keyword argument writeback=True may consume vast amount
of memory for the cache, and it may make d.close() very slow, if you
access many of d&#8217;s entries after opening it in this way: d has no way to
check which of the entries you access are mutable and/or which ones you
actually mutate, so it must cache, and write back at close, all of the
entries that you access.  You can call d.sync() to write back all the
entries in the cache, and empty the cache (d.sync() also synchronizes
the persistent dictionary on disk, if feasible).</p>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/shelve.BsdDbShelf.html#shelve.BsdDbShelf" title="shelve.BsdDbShelf"><code class="xref py py-obj docutils literal"><span class="pre">BsdDbShelf</span></code></a>(dict[,&nbsp;protocol,&nbsp;writeback])</td>
<td>Shelf implementation using the &#8220;BSD&#8221; db interface.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/shelve.DbfilenameShelf.html#shelve.DbfilenameShelf" title="shelve.DbfilenameShelf"><code class="xref py py-obj docutils literal"><span class="pre">DbfilenameShelf</span></code></a>(filename[,&nbsp;flag,&nbsp;protocol,&nbsp;...])</td>
<td>Shelf implementation using the &#8220;anydbm&#8221; generic dbm interface.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/shelve.Shelf.html#shelve.Shelf" title="shelve.Shelf"><code class="xref py py-obj docutils literal"><span class="pre">Shelf</span></code></a>(dict[,&nbsp;protocol,&nbsp;writeback])</td>
<td>Base class for shelf implementations.</td>
</tr>
</tbody>
</table>
<div class="toctree-wrapper compound">
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="generated/shelve.BsdDbShelf.html" class="btn btn-neutral float-right" title="shelve.BsdDbShelf" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="copy_reg.html" class="btn btn-neutral" title="copy_reg" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/copybutton.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>