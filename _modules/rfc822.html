

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>rfc822 &mdash; Python Standard Library</title>
  

  
  
    <link rel="shortcut icon" href="../_static/py.png"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Python Standard Library" href="../index.html"/>
        <link rel="up" title="Module code" href="index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Python Standard Library
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../01to10.html">Ch 01 - 10</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11to20.html">Ch 11 - 20</a></li>
<li class="toctree-l1"><a class="reference internal" href="../21to30.html">Ch 21 - 30</a></li>
<li class="toctree-l1"><a class="reference internal" href="../31to37.html">Ch 31 - 37</a></li>
</ul>
<p class="caption"><span class="caption-text">Autogenerated API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api_06to10.html">API: 06 - 10</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_11to15.html">API: 11 - 15</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_16to20.html">API: 16 - 20</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_21to25.html">API: 21 - 25</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_26to30.html">API: 26 - 30</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_31to37.html">API: 31 - 37</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Python Standard Library</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          













<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Module code</a> &raquo;</li>
        
      <li>rfc822</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for rfc822</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;RFC 2822 message manipulation.</span>

<span class="sd">Note: This is only a very rough sketch of a full RFC-822 parser; in particular</span>
<span class="sd">the tokenizing of addresses does not adhere to all the quoting rules.</span>

<span class="sd">Note: RFC 2822 is a long awaited update to RFC 822.  This module should</span>
<span class="sd">conform to RFC 2822, and is thus mis-named (it&#39;s not worth renaming it).  Some</span>
<span class="sd">effort at RFC 2822 updates have been made, but a thorough audit has not been</span>
<span class="sd">performed.  Consider any RFC 2822 non-conformance to be a bug.</span>

<span class="sd">    RFC 2822: http://www.faqs.org/rfcs/rfc2822.html</span>
<span class="sd">    RFC 822 : http://www.faqs.org/rfcs/rfc822.html (obsolete)</span>

<span class="sd">Directions for use:</span>

<span class="sd">To create a Message object: first open a file, e.g.:</span>

<span class="sd">  fp = open(file, &#39;r&#39;)</span>

<span class="sd">You can use any other legal way of getting an open file object, e.g. use</span>
<span class="sd">sys.stdin or call os.popen().  Then pass the open file object to the Message()</span>
<span class="sd">constructor:</span>

<span class="sd">  m = Message(fp)</span>

<span class="sd">This class can work with any input object that supports a readline method.  If</span>
<span class="sd">the input object has seek and tell capability, the rewindbody method will</span>
<span class="sd">work; also illegal lines will be pushed back onto the input stream.  If the</span>
<span class="sd">input object lacks seek but has an `unread&#39; method that can push back a line</span>
<span class="sd">of input, Message will use that to push back illegal lines.  Thus this class</span>
<span class="sd">can be used to parse messages coming from a buffered stream.</span>

<span class="sd">The optional `seekable&#39; argument is provided as a workaround for certain stdio</span>
<span class="sd">libraries in which tell() discards buffered data before discovering that the</span>
<span class="sd">lseek() system call doesn&#39;t work.  For maximum portability, you should set the</span>
<span class="sd">seekable argument to zero to prevent that initial \code{tell} when passing in</span>
<span class="sd">an unseekable object such as a file object created from a socket object.  If</span>
<span class="sd">it is 1 on entry -- which it is by default -- the tell() method of the open</span>
<span class="sd">file object is called once; if this raises an exception, seekable is reset to</span>
<span class="sd">0.  For other nonzero values of seekable, this test is not made.</span>

<span class="sd">To get the text of a particular header there are several methods:</span>

<span class="sd">  str = m.getheader(name)</span>
<span class="sd">  str = m.getrawheader(name)</span>

<span class="sd">where name is the name of the header, e.g. &#39;Subject&#39;.  The difference is that</span>
<span class="sd">getheader() strips the leading and trailing whitespace, while getrawheader()</span>
<span class="sd">doesn&#39;t.  Both functions retain embedded whitespace (including newlines)</span>
<span class="sd">exactly as they are specified in the header, and leave the case of the text</span>
<span class="sd">unchanged.</span>

<span class="sd">For addresses and address lists there are functions</span>

<span class="sd">  realname, mailaddress = m.getaddr(name)</span>
<span class="sd">  list = m.getaddrlist(name)</span>

<span class="sd">where the latter returns a list of (realname, mailaddr) tuples.</span>

<span class="sd">There is also a method</span>

<span class="sd">  time = m.getdate(name)</span>

<span class="sd">which parses a Date-like field and returns a time-compatible tuple,</span>
<span class="sd">i.e. a tuple such as returned by time.localtime() or accepted by</span>
<span class="sd">time.mktime().</span>

<span class="sd">See the class definition for lower level access methods.</span>

<span class="sd">There are also some utility functions here.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># Cleanup and extensions by Eric S. Raymond &lt;esr@thyrsus.com&gt;</span>

<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">from</span> <span class="nn">warnings</span> <span class="kn">import</span> <span class="n">warnpy3k</span>
<span class="n">warnpy3k</span><span class="p">(</span><span class="s2">&quot;in 3.x, rfc822 has been removed in favor of the email package&quot;</span><span class="p">,</span>
         <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Message&quot;</span><span class="p">,</span><span class="s2">&quot;AddressList&quot;</span><span class="p">,</span><span class="s2">&quot;parsedate&quot;</span><span class="p">,</span><span class="s2">&quot;parsedate_tz&quot;</span><span class="p">,</span><span class="s2">&quot;mktime_tz&quot;</span><span class="p">]</span>

<span class="n">_blanklines</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>            <span class="c1"># Optimization for islast()</span>


<div class="viewcode-block" id="Message"><a class="viewcode-back" href="../generated/generated/rfc822.Message.html#rfc822.Message">[docs]</a><span class="k">class</span> <span class="nc">Message</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Represents a single RFC 2822-compliant message.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="Message.__init__"><a class="viewcode-back" href="../generated/generated/rfc822.Message.__init__.html#rfc822.Message.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">seekable</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the class instance and read the headers.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">seekable</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Exercise tell() to make sure it works</span>
            <span class="c1"># (and then assume seek() works, too)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fp</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">IOError</span><span class="p">):</span>
                <span class="n">seekable</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fp</span> <span class="o">=</span> <span class="n">fp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seekable</span> <span class="o">=</span> <span class="n">seekable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startofheaders</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startofbody</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1">#</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">seekable</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">startofheaders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">seekable</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readheaders</span><span class="p">()</span>
        <span class="c1">#</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">seekable</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">startofbody</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">seekable</span> <span class="o">=</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="Message.rewindbody"><a class="viewcode-back" href="../generated/generated/rfc822.Message.rewindbody.html#rfc822.Message.rewindbody">[docs]</a>    <span class="k">def</span> <span class="nf">rewindbody</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rewind the file to the start of the body (if seekable).&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">seekable</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">,</span> <span class="s2">&quot;unseekable file&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">startofbody</span><span class="p">)</span></div>

<div class="viewcode-block" id="Message.readheaders"><a class="viewcode-back" href="../generated/generated/rfc822.Message.readheaders.html#rfc822.Message.readheaders">[docs]</a>    <span class="k">def</span> <span class="nf">readheaders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read header lines.</span>

<span class="sd">        Read header lines up to the entirely blank line that terminates them.</span>
<span class="sd">        The (normally blank) line that ends the headers is skipped, but not</span>
<span class="sd">        included in the returned list.  If a non-header line ends the headers,</span>
<span class="sd">        (which is an error), an attempt is made to backspace over it; it is</span>
<span class="sd">        never included in the returned list.</span>

<span class="sd">        The variable self.status is set to the empty string if all went well,</span>
<span class="sd">        otherwise it is an error message.  The variable self.headers is a</span>
<span class="sd">        completely uninterpreted list of lines contained in the header (so</span>
<span class="sd">        printing them will reproduce the header exactly as it appears in the</span>
<span class="sd">        file).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unixfrom</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">headerseen</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">firstline</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">startofline</span> <span class="o">=</span> <span class="n">unread</span> <span class="o">=</span> <span class="n">tell</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="p">,</span> <span class="s1">&#39;unread&#39;</span><span class="p">):</span>
            <span class="n">unread</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">unread</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">seekable</span><span class="p">:</span>
            <span class="n">tell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">tell</span>
        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">tell</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">startofline</span> <span class="o">=</span> <span class="n">tell</span><span class="p">()</span>
                <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
                    <span class="n">startofline</span> <span class="o">=</span> <span class="n">tell</span> <span class="o">=</span> <span class="bp">None</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">seekable</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;EOF in headers&#39;</span>
                <span class="k">break</span>
            <span class="c1"># Skip unix From name time lines</span>
            <span class="k">if</span> <span class="n">firstline</span> <span class="ow">and</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;From &#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unixfrom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unixfrom</span> <span class="o">+</span> <span class="n">line</span>
                <span class="k">continue</span>
            <span class="n">firstline</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">headerseen</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="s1">&#39; </span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">:</span>
                <span class="c1"># It&#39;s a continuation line.</span>
                <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="n">headerseen</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span> <span class="o">+</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="n">headerseen</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">iscomment</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
                <span class="c1"># It&#39;s a comment.  Ignore it.</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">islast</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
                <span class="c1"># Note! No pushback here!  The delimiter line gets eaten.</span>
                <span class="k">break</span>
            <span class="n">headerseen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">isheader</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">headerseen</span><span class="p">:</span>
                <span class="c1"># It&#39;s a legal header line, save it.</span>
                <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="n">headerseen</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">headerseen</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="n">headerseen</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c1"># An empty header name. These aren&#39;t allowed in HTTP, but it&#39;s</span>
                <span class="c1"># probably a benign mistake. Don&#39;t add the header, just keep</span>
                <span class="c1"># going.</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># It&#39;s not a header line; throw it back and stop here.</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;No headers&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;Non-header line where header expected&#39;</span>
                <span class="c1"># Try to undo the read.</span>
                <span class="k">if</span> <span class="n">unread</span><span class="p">:</span>
                    <span class="n">unread</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">tell</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">startofline</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">+</span> <span class="s1">&#39;; bad seek&#39;</span>
                <span class="k">break</span></div>

<div class="viewcode-block" id="Message.isheader"><a class="viewcode-back" href="../generated/generated/rfc822.Message.isheader.html#rfc822.Message.isheader">[docs]</a>    <span class="k">def</span> <span class="nf">isheader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Determine whether a given line is a legal header.</span>

<span class="sd">        This method should return the header name, suitably canonicalized.</span>
<span class="sd">        You may override this method in order to use Message parsing on tagged</span>
<span class="sd">        data in RFC 2822-like formats with special header formats.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">line</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">None</span></div>

<div class="viewcode-block" id="Message.islast"><a class="viewcode-back" href="../generated/generated/rfc822.Message.islast.html#rfc822.Message.islast">[docs]</a>    <span class="k">def</span> <span class="nf">islast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Determine whether a line is a legal end of RFC 2822 headers.</span>

<span class="sd">        You may override this method if your application wants to bend the</span>
<span class="sd">        rules, e.g. to strip trailing whitespace, or to recognize MH template</span>
<span class="sd">        separators (&#39;--------&#39;).  For convenience (e.g. for code reading from</span>
<span class="sd">        sockets) a line consisting of \\r\\n also matches.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">_blanklines</span></div>

<div class="viewcode-block" id="Message.iscomment"><a class="viewcode-back" href="../generated/generated/rfc822.Message.iscomment.html#rfc822.Message.iscomment">[docs]</a>    <span class="k">def</span> <span class="nf">iscomment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Determine whether a line should be skipped entirely.</span>

<span class="sd">        You may override this method in order to use Message parsing on tagged</span>
<span class="sd">        data in RFC 2822-like formats that support embedded comments or</span>
<span class="sd">        free-text data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">False</span></div>

<div class="viewcode-block" id="Message.getallmatchingheaders"><a class="viewcode-back" href="../generated/generated/rfc822.Message.getallmatchingheaders.html#rfc822.Message.getallmatchingheaders">[docs]</a>    <span class="k">def</span> <span class="nf">getallmatchingheaders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Find all header lines matching a given header name.</span>

<span class="sd">        Look through the list of headers and find all lines matching a given</span>
<span class="sd">        header name (and their continuation lines).  A list of the lines is</span>
<span class="sd">        returned, without interpretation.  If the header does not occur, an</span>
<span class="sd">        empty list is returned.  If the header occurs multiple times, all</span>
<span class="sd">        occurrences are returned.  Case is not important in the header name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">hit</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                <span class="n">hit</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">line</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isspace</span><span class="p">():</span>
                <span class="n">hit</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">hit</span><span class="p">:</span>
                <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lst</span></div>

<div class="viewcode-block" id="Message.getfirstmatchingheader"><a class="viewcode-back" href="../generated/generated/rfc822.Message.getfirstmatchingheader.html#rfc822.Message.getfirstmatchingheader">[docs]</a>    <span class="k">def</span> <span class="nf">getfirstmatchingheader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the first header line matching name.</span>

<span class="sd">        This is similar to getallmatchingheaders, but it returns only the</span>
<span class="sd">        first matching header (and its continuation lines).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">hit</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hit</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isspace</span><span class="p">():</span>
                    <span class="k">break</span>
            <span class="k">elif</span> <span class="n">line</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                <span class="n">hit</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">hit</span><span class="p">:</span>
                <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lst</span></div>

<div class="viewcode-block" id="Message.getrawheader"><a class="viewcode-back" href="../generated/generated/rfc822.Message.getrawheader.html#rfc822.Message.getrawheader">[docs]</a>    <span class="k">def</span> <span class="nf">getrawheader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A higher-level interface to getfirstmatchingheader().</span>

<span class="sd">        Return a string containing the literal text of the header but with the</span>
<span class="sd">        keyword stripped.  All leading, trailing and embedded whitespace is</span>
<span class="sd">        kept in the string, however.  Return None if the header does not</span>
<span class="sd">        occur.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">lst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getfirstmatchingheader</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">lst</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span></div>

<div class="viewcode-block" id="Message.getheader"><a class="viewcode-back" href="../generated/generated/rfc822.Message.getheader.html#rfc822.Message.getheader">[docs]</a>    <span class="k">def</span> <span class="nf">getheader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the header value for a name.</span>

<span class="sd">        This is the normal interface: it returns a stripped version of the</span>
<span class="sd">        header value for a given header name, or None if it doesn&#39;t exist.</span>
<span class="sd">        This uses the dictionary version which finds the *last* such header.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">default</span><span class="p">)</span></div>
    <span class="n">get</span> <span class="o">=</span> <span class="n">getheader</span>

<div class="viewcode-block" id="Message.getheaders"><a class="viewcode-back" href="../generated/generated/rfc822.Message.getheaders.html#rfc822.Message.getheaders">[docs]</a>    <span class="k">def</span> <span class="nf">getheaders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get all values for a header.</span>

<span class="sd">        This returns a list of values for headers given more than once; each</span>
<span class="sd">        value in the result list is stripped in the same way as the result of</span>
<span class="sd">        getheader().  If the header is not given, return an empty list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">current</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">have_header</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getallmatchingheaders</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isspace</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">current</span><span class="p">:</span>
                    <span class="n">current</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">current</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">have_header</span><span class="p">:</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
                <span class="n">current</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="n">have_header</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">have_header</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="Message.getaddr"><a class="viewcode-back" href="../generated/generated/rfc822.Message.getaddr.html#rfc822.Message.getaddr">[docs]</a>    <span class="k">def</span> <span class="nf">getaddr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a single address from a header, as a tuple.</span>

<span class="sd">        An example return value:</span>
<span class="sd">        (&#39;Guido van Rossum&#39;, &#39;guido@cwi.nl&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># New, by Ben Escoto</span>
        <span class="n">alist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getaddrlist</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">alist</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">alist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="Message.getaddrlist"><a class="viewcode-back" href="../generated/generated/rfc822.Message.getaddrlist.html#rfc822.Message.getaddrlist">[docs]</a>    <span class="k">def</span> <span class="nf">getaddrlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a list of addresses from a header.</span>

<span class="sd">        Retrieves a list of addresses from a header, where each address is a</span>
<span class="sd">        tuple as returned by getaddr().  Scans all named headers, so it works</span>
<span class="sd">        properly with multiple To: or Cc: headers for example.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getallmatchingheaders</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="s1">&#39; </span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">:</span>
                <span class="n">raw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">raw</span><span class="p">:</span>
                    <span class="n">raw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">addr</span> <span class="o">=</span> <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
                <span class="n">raw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
        <span class="n">alladdrs</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">AddressList</span><span class="p">(</span><span class="n">alladdrs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">addresslist</span></div>

<div class="viewcode-block" id="Message.getdate"><a class="viewcode-back" href="../generated/generated/rfc822.Message.getdate.html#rfc822.Message.getdate">[docs]</a>    <span class="k">def</span> <span class="nf">getdate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve a date field from a header.</span>

<span class="sd">        Retrieves a date field from the named header, returning a tuple</span>
<span class="sd">        compatible with time.mktime().</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="n">parsedate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div>

<div class="viewcode-block" id="Message.getdate_tz"><a class="viewcode-back" href="../generated/generated/rfc822.Message.getdate_tz.html#rfc822.Message.getdate_tz">[docs]</a>    <span class="k">def</span> <span class="nf">getdate_tz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Retrieve a date field from a header as a 10-tuple.</span>

<span class="sd">        The first 9 elements make up a tuple compatible with time.mktime(),</span>
<span class="sd">        and the 10th is the offset of the poster&#39;s time zone from GMT/UTC.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="n">parsedate_tz</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div>


    <span class="c1"># Access as a dictionary (only finds *last* header of each type):</span>

<div class="viewcode-block" id="Message.__len__"><a class="viewcode-back" href="../generated/generated/rfc822.Message.__len__.html#rfc822.Message.__len__">[docs]</a>    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the number of headers in a message.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">)</span></div>

<div class="viewcode-block" id="Message.__getitem__"><a class="viewcode-back" href="../generated/generated/rfc822.Message.__getitem__.html#rfc822.Message.__getitem__">[docs]</a>    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a specific header, as from a dictionary.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span></div>

<div class="viewcode-block" id="Message.__setitem__"><a class="viewcode-back" href="../generated/generated/rfc822.Message.__setitem__.html#rfc822.Message.__setitem__">[docs]</a>    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the value of a header.</span>

<span class="sd">        Note: This is not a perfect inversion of __getitem__, because any</span>
<span class="sd">        changed headers get stuck at the end of the raw-headers list rather</span>
<span class="sd">        than where the altered header was.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">del</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="c1"># Won&#39;t fail if it doesn&#39;t exist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">value</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Message.__delitem__"><a class="viewcode-back" href="../generated/generated/rfc822.Message.__delitem__.html#rfc822.Message.__delitem__">[docs]</a>    <span class="k">def</span> <span class="nf">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete all occurrences of a specific header, if it is present.&quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">hit</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                <span class="n">hit</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">line</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isspace</span><span class="p">():</span>
                <span class="n">hit</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">hit</span><span class="p">:</span>
                <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></div>

<div class="viewcode-block" id="Message.setdefault"><a class="viewcode-back" href="../generated/generated/rfc822.Message.setdefault.html#rfc822.Message.setdefault">[docs]</a>    <span class="k">def</span> <span class="nf">setdefault</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="n">lowername</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">lowername</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="n">lowername</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="n">default</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="n">lowername</span><span class="p">]</span> <span class="o">=</span> <span class="n">default</span>
            <span class="k">return</span> <span class="n">default</span></div>

<div class="viewcode-block" id="Message.has_key"><a class="viewcode-back" href="../generated/generated/rfc822.Message.has_key.html#rfc822.Message.has_key">[docs]</a>    <span class="k">def</span> <span class="nf">has_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Determine whether a message contains the named header.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span></div>

<div class="viewcode-block" id="Message.__contains__"><a class="viewcode-back" href="../generated/generated/rfc822.Message.__contains__.html#rfc822.Message.__contains__">[docs]</a>    <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Determine whether a message contains the named header.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span></div>

<div class="viewcode-block" id="Message.__iter__"><a class="viewcode-back" href="../generated/generated/rfc822.Message.__iter__.html#rfc822.Message.__iter__">[docs]</a>    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">)</span></div>

<div class="viewcode-block" id="Message.keys"><a class="viewcode-back" href="../generated/generated/rfc822.Message.keys.html#rfc822.Message.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get all of a message&#39;s header field names.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span></div>

<div class="viewcode-block" id="Message.values"><a class="viewcode-back" href="../generated/generated/rfc822.Message.values.html#rfc822.Message.values">[docs]</a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get all of a message&#39;s header field values.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span></div>

<div class="viewcode-block" id="Message.items"><a class="viewcode-back" href="../generated/generated/rfc822.Message.items.html#rfc822.Message.items">[docs]</a>    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get all of a message&#39;s headers.</span>

<span class="sd">        Returns a list of name, value tuples.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span></div>

<div class="viewcode-block" id="Message.__str__"><a class="viewcode-back" href="../generated/generated/rfc822.Message.__str__.html#rfc822.Message.__str__">[docs]</a>    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span></div></div>


<span class="c1"># Utility functions</span>
<span class="c1"># -----------------</span>

<span class="c1"># XXX Should fix unquote() and quote() to be really conformant.</span>
<span class="c1"># XXX The inverses of the parse functions may also be useful.</span>


<div class="viewcode-block" id="unquote"><a class="viewcode-back" href="../generated/rfc822.unquote.html#rfc822.unquote">[docs]</a><span class="k">def</span> <span class="nf">unquote</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Remove quotes from a string.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;&lt;&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">s</span></div>


<div class="viewcode-block" id="quote"><a class="viewcode-back" href="../generated/rfc822.quote.html#rfc822.quote">[docs]</a><span class="k">def</span> <span class="nf">quote</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add quotes around a string.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\\\</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&quot;&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="parseaddr"><a class="viewcode-back" href="../generated/rfc822.parseaddr.html#rfc822.parseaddr">[docs]</a><span class="k">def</span> <span class="nf">parseaddr</span><span class="p">(</span><span class="n">address</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parse an address into a (realname, mailaddr) tuple.&quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">AddressList</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
    <span class="n">lst</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">addresslist</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">lst</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>


<div class="viewcode-block" id="AddrlistClass"><a class="viewcode-back" href="../generated/generated/rfc822.AddrlistClass.html#rfc822.AddrlistClass">[docs]</a><span class="k">class</span> <span class="nc">AddrlistClass</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Address parser class by Ben Escoto.</span>

<span class="sd">    To understand what this class does, it helps to have a copy of</span>
<span class="sd">    RFC 2822 in front of you.</span>

<span class="sd">    http://www.faqs.org/rfcs/rfc2822.html</span>

<span class="sd">    Note: this class interface is deprecated and may be removed in the future.</span>
<span class="sd">    Use rfc822.AddressList instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="AddrlistClass.__init__"><a class="viewcode-back" href="../generated/generated/rfc822.AddrlistClass.__init__.html#rfc822.AddrlistClass.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize a new instance.</span>

<span class="sd">        `field&#39; is an unparsed address header field, containing one or more</span>
<span class="sd">        addresses.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specials</span> <span class="o">=</span> <span class="s1">&#39;()&lt;&gt;@,:;.</span><span class="se">\&quot;</span><span class="s1">[]&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LWS</span> <span class="o">=</span> <span class="s1">&#39; </span><span class="se">\t</span><span class="s1">&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CR</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atomends</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specials</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">LWS</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">CR</span>
        <span class="c1"># Note that RFC 2822 now specifies `.&#39; as obs-phrase, meaning that it</span>
        <span class="c1"># is obsolete syntax.  RFC 2822 requires that we recognize obsolete</span>
        <span class="c1"># syntax, so allow dots in phrases.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phraseends</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomends</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">field</span> <span class="o">=</span> <span class="n">field</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">commentlist</span> <span class="o">=</span> <span class="p">[]</span></div>

<div class="viewcode-block" id="AddrlistClass.gotonext"><a class="viewcode-back" href="../generated/generated/rfc822.AddrlistClass.gotonext.html#rfc822.AddrlistClass.gotonext">[docs]</a>    <span class="k">def</span> <span class="nf">gotonext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse up to the start of the next address.&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">LWS</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n\r</span><span class="s1">&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">commentlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getcomment</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span> <span class="k">break</span></div>

<div class="viewcode-block" id="AddrlistClass.getaddrlist"><a class="viewcode-back" href="../generated/generated/rfc822.AddrlistClass.getaddrlist.html#rfc822.AddrlistClass.getaddrlist">[docs]</a>    <span class="k">def</span> <span class="nf">getaddrlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse all addresses.</span>

<span class="sd">        Returns a list containing all of the addresses.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getaddress</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">ad</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="n">ad</span>
            <span class="n">ad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getaddress</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="AddrlistClass.getaddress"><a class="viewcode-back" href="../generated/generated/rfc822.AddrlistClass.getaddress.html#rfc822.AddrlistClass.getaddress">[docs]</a>    <span class="k">def</span> <span class="nf">getaddress</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse the next address.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">commentlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gotonext</span><span class="p">()</span>

        <span class="n">oldpos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span>
        <span class="n">oldcl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">commentlist</span>
        <span class="n">plist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getphraselist</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">gotonext</span><span class="p">()</span>
        <span class="n">returnlist</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">):</span>
            <span class="c1"># Bad email address technically, no domain.</span>
            <span class="k">if</span> <span class="n">plist</span><span class="p">:</span>
                <span class="n">returnlist</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">commentlist</span><span class="p">),</span> <span class="n">plist</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="ow">in</span> <span class="s1">&#39;.@&#39;</span><span class="p">:</span>
            <span class="c1"># email address is just an addrspec</span>
            <span class="c1"># this isn&#39;t very efficient since we start over</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">oldpos</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">commentlist</span> <span class="o">=</span> <span class="n">oldcl</span>
            <span class="n">addrspec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getaddrspec</span><span class="p">()</span>
            <span class="n">returnlist</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">commentlist</span><span class="p">),</span> <span class="n">addrspec</span><span class="p">)]</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span>
            <span class="c1"># address is a group</span>
            <span class="n">returnlist</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="n">fieldlen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gotonext</span><span class="p">()</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="n">fieldlen</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;;&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">break</span>
                <span class="n">returnlist</span> <span class="o">=</span> <span class="n">returnlist</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">getaddress</span><span class="p">()</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">:</span>
            <span class="c1"># Address is a phrase then a route addr</span>
            <span class="n">routeaddr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getrouteaddr</span><span class="p">()</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">commentlist</span><span class="p">:</span>
                <span class="n">returnlist</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">plist</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> \
                         <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">commentlist</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="n">routeaddr</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">returnlist</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">plist</span><span class="p">),</span> <span class="n">routeaddr</span><span class="p">)]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">plist</span><span class="p">:</span>
                <span class="n">returnlist</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">commentlist</span><span class="p">),</span> <span class="n">plist</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specials</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">gotonext</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;,&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">returnlist</span></div>

<div class="viewcode-block" id="AddrlistClass.getrouteaddr"><a class="viewcode-back" href="../generated/generated/rfc822.AddrlistClass.getrouteaddr.html#rfc822.AddrlistClass.getrouteaddr">[docs]</a>    <span class="k">def</span> <span class="nf">getrouteaddr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse a route address (Return-path value).</span>

<span class="sd">        This method just skips all the route stuff and returns the addrspec.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">expectroute</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gotonext</span><span class="p">()</span>
        <span class="n">adlist</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">expectroute</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">getdomain</span><span class="p">()</span>
                <span class="n">expectroute</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">break</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;@&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">expectroute</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">adlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getaddrspec</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">break</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gotonext</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">adlist</span></div>

<div class="viewcode-block" id="AddrlistClass.getaddrspec"><a class="viewcode-back" href="../generated/generated/rfc822.AddrlistClass.getaddrspec.html#rfc822.AddrlistClass.getaddrspec">[docs]</a>    <span class="k">def</span> <span class="nf">getaddrspec</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse an RFC 2822 addr-spec.&quot;&quot;&quot;</span>
        <span class="n">aslist</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">gotonext</span><span class="p">()</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;.&#39;</span><span class="p">:</span>
                <span class="n">aslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">:</span>
                <span class="n">aslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">getquote</span><span class="p">())</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomends</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">aslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getatom</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gotonext</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;@&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">aslist</span><span class="p">)</span>

        <span class="n">aslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gotonext</span><span class="p">()</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">aslist</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">getdomain</span><span class="p">()</span></div>

<div class="viewcode-block" id="AddrlistClass.getdomain"><a class="viewcode-back" href="../generated/generated/rfc822.AddrlistClass.getdomain.html#rfc822.AddrlistClass.getdomain">[docs]</a>    <span class="k">def</span> <span class="nf">getdomain</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the complete domain name from an address.&quot;&quot;&quot;</span>
        <span class="n">sdlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">LWS</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">commentlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getcomment</span><span class="p">())</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;[&#39;</span><span class="p">:</span>
                <span class="n">sdlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getdomainliteral</span><span class="p">())</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;.&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">sdlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomends</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">sdlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getatom</span><span class="p">())</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sdlist</span><span class="p">)</span></div>

<div class="viewcode-block" id="AddrlistClass.getdelimited"><a class="viewcode-back" href="../generated/generated/rfc822.AddrlistClass.getdelimited.html#rfc822.AddrlistClass.getdelimited">[docs]</a>    <span class="k">def</span> <span class="nf">getdelimited</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">beginchar</span><span class="p">,</span> <span class="n">endchars</span><span class="p">,</span> <span class="n">allowcomments</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse a header fragment delimited by special characters.</span>

<span class="sd">        `beginchar&#39; is the start character for the fragment.  If self is not</span>
<span class="sd">        looking at an instance of `beginchar&#39; then getdelimited returns the</span>
<span class="sd">        empty string.</span>

<span class="sd">        `endchars&#39; is a sequence of allowable end-delimiting characters.</span>
<span class="sd">        Parsing stops when one of these is encountered.</span>

<span class="sd">        If `allowcomments&#39; is non-zero, embedded RFC 2822 comments are allowed</span>
<span class="sd">        within the parsed fragment.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="o">!=</span> <span class="n">beginchar</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

        <span class="n">slist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
        <span class="n">quote</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">quote</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">slist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">])</span>
                <span class="n">quote</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="ow">in</span> <span class="n">endchars</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">break</span>
            <span class="k">elif</span> <span class="n">allowcomments</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span><span class="p">:</span>
                <span class="n">slist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getcomment</span><span class="p">())</span>
                <span class="k">continue</span>        <span class="c1"># have already advanced pos from getcomment</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">:</span>
                <span class="n">quote</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">slist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">slist</span><span class="p">)</span></div>

<div class="viewcode-block" id="AddrlistClass.getquote"><a class="viewcode-back" href="../generated/generated/rfc822.AddrlistClass.getquote.html#rfc822.AddrlistClass.getquote">[docs]</a>    <span class="k">def</span> <span class="nf">getquote</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a quote-delimited fragment from self&#39;s field.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getdelimited</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;&quot;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="AddrlistClass.getcomment"><a class="viewcode-back" href="../generated/generated/rfc822.AddrlistClass.getcomment.html#rfc822.AddrlistClass.getcomment">[docs]</a>    <span class="k">def</span> <span class="nf">getcomment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a parenthesis-delimited fragment from self&#39;s field.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getdelimited</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="s1">&#39;)</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="AddrlistClass.getdomainliteral"><a class="viewcode-back" href="../generated/generated/rfc822.AddrlistClass.getdomainliteral.html#rfc822.AddrlistClass.getdomainliteral">[docs]</a>    <span class="k">def</span> <span class="nf">getdomainliteral</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse an RFC 2822 domain-literal.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">getdelimited</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="s1">&#39;]</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="AddrlistClass.getatom"><a class="viewcode-back" href="../generated/generated/rfc822.AddrlistClass.getatom.html#rfc822.AddrlistClass.getatom">[docs]</a>    <span class="k">def</span> <span class="nf">getatom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atomends</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse an RFC 2822 atom.</span>

<span class="sd">        Optional atomends specifies a different set of end token delimiters</span>
<span class="sd">        (the default is to use self.atomends).  This is used e.g. in</span>
<span class="sd">        getphraselist() since phrase endings must not include the `.&#39; (which</span>
<span class="sd">        is legal in phrases).&quot;&quot;&quot;</span>
        <span class="n">atomlist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">atomends</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">atomends</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomends</span>

        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="ow">in</span> <span class="n">atomends</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">atomlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">atomlist</span><span class="p">)</span></div>

<div class="viewcode-block" id="AddrlistClass.getphraselist"><a class="viewcode-back" href="../generated/generated/rfc822.AddrlistClass.getphraselist.html#rfc822.AddrlistClass.getphraselist">[docs]</a>    <span class="k">def</span> <span class="nf">getphraselist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse a sequence of RFC 2822 phrases.</span>

<span class="sd">        A phrase is a sequence of words, which are in turn either RFC 2822</span>
<span class="sd">        atoms or quoted-strings.  Phrases are canonicalized by squeezing all</span>
<span class="sd">        runs of continuous whitespace into one space.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plist</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">LWS</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">:</span>
                <span class="n">plist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getquote</span><span class="p">())</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;(&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">commentlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getcomment</span><span class="p">())</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">phraseends</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getatom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phraseends</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">plist</span></div></div>

<div class="viewcode-block" id="AddressList"><a class="viewcode-back" href="../generated/generated/rfc822.AddressList.html#rfc822.AddressList">[docs]</a><span class="k">class</span> <span class="nc">AddressList</span><span class="p">(</span><span class="n">AddrlistClass</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An AddressList encapsulates a list of parsed RFC 2822 addresses.&quot;&quot;&quot;</span>
<div class="viewcode-block" id="AddressList.__init__"><a class="viewcode-back" href="../generated/generated/rfc822.AddressList.__init__.html#rfc822.AddressList.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">):</span>
        <span class="n">AddrlistClass</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addresslist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getaddrlist</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addresslist</span> <span class="o">=</span> <span class="p">[]</span></div>

<div class="viewcode-block" id="AddressList.__len__"><a class="viewcode-back" href="../generated/generated/rfc822.AddressList.__len__.html#rfc822.AddressList.__len__">[docs]</a>    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">addresslist</span><span class="p">)</span></div>

<div class="viewcode-block" id="AddressList.__str__"><a class="viewcode-back" href="../generated/generated/rfc822.AddressList.__str__.html#rfc822.AddressList.__str__">[docs]</a>    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">dump_address_pair</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">addresslist</span><span class="p">))</span></div>

<div class="viewcode-block" id="AddressList.__add__"><a class="viewcode-back" href="../generated/generated/rfc822.AddressList.__add__.html#rfc822.AddressList.__add__">[docs]</a>    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="c1"># Set union</span>
        <span class="n">newaddr</span> <span class="o">=</span> <span class="n">AddressList</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="n">newaddr</span><span class="o">.</span><span class="n">addresslist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">addresslist</span><span class="p">[:]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">addresslist</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">addresslist</span><span class="p">:</span>
                <span class="n">newaddr</span><span class="o">.</span><span class="n">addresslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">newaddr</span></div>

<div class="viewcode-block" id="AddressList.__iadd__"><a class="viewcode-back" href="../generated/generated/rfc822.AddressList.__iadd__.html#rfc822.AddressList.__iadd__">[docs]</a>    <span class="k">def</span> <span class="nf">__iadd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="c1"># Set union, in-place</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">addresslist</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">addresslist</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addresslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="AddressList.__sub__"><a class="viewcode-back" href="../generated/generated/rfc822.AddressList.__sub__.html#rfc822.AddressList.__sub__">[docs]</a>    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="c1"># Set difference</span>
        <span class="n">newaddr</span> <span class="o">=</span> <span class="n">AddressList</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">addresslist</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">addresslist</span><span class="p">:</span>
                <span class="n">newaddr</span><span class="o">.</span><span class="n">addresslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">newaddr</span></div>

<div class="viewcode-block" id="AddressList.__isub__"><a class="viewcode-back" href="../generated/generated/rfc822.AddressList.__isub__.html#rfc822.AddressList.__isub__">[docs]</a>    <span class="k">def</span> <span class="nf">__isub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="c1"># Set difference, in-place</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">addresslist</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">addresslist</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addresslist</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="AddressList.__getitem__"><a class="viewcode-back" href="../generated/generated/rfc822.AddressList.__getitem__.html#rfc822.AddressList.__getitem__">[docs]</a>    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="c1"># Make indexing, slices, and &#39;in&#39; work</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">addresslist</span><span class="p">[</span><span class="n">index</span><span class="p">]</span></div></div>

<div class="viewcode-block" id="dump_address_pair"><a class="viewcode-back" href="../generated/rfc822.dump_address_pair.html#rfc822.dump_address_pair">[docs]</a><span class="k">def</span> <span class="nf">dump_address_pair</span><span class="p">(</span><span class="n">pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Dump a (name, address) pair in a canonicalized form.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">return</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;&quot; &lt;&#39;</span> <span class="o">+</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;&gt;&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>

<span class="c1"># Parse a date field</span>

<span class="n">_monthnames</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;jan&#39;</span><span class="p">,</span> <span class="s1">&#39;feb&#39;</span><span class="p">,</span> <span class="s1">&#39;mar&#39;</span><span class="p">,</span> <span class="s1">&#39;apr&#39;</span><span class="p">,</span> <span class="s1">&#39;may&#39;</span><span class="p">,</span> <span class="s1">&#39;jun&#39;</span><span class="p">,</span> <span class="s1">&#39;jul&#39;</span><span class="p">,</span>
               <span class="s1">&#39;aug&#39;</span><span class="p">,</span> <span class="s1">&#39;sep&#39;</span><span class="p">,</span> <span class="s1">&#39;oct&#39;</span><span class="p">,</span> <span class="s1">&#39;nov&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">,</span>
               <span class="s1">&#39;january&#39;</span><span class="p">,</span> <span class="s1">&#39;february&#39;</span><span class="p">,</span> <span class="s1">&#39;march&#39;</span><span class="p">,</span> <span class="s1">&#39;april&#39;</span><span class="p">,</span> <span class="s1">&#39;may&#39;</span><span class="p">,</span> <span class="s1">&#39;june&#39;</span><span class="p">,</span> <span class="s1">&#39;july&#39;</span><span class="p">,</span>
               <span class="s1">&#39;august&#39;</span><span class="p">,</span> <span class="s1">&#39;september&#39;</span><span class="p">,</span> <span class="s1">&#39;october&#39;</span><span class="p">,</span> <span class="s1">&#39;november&#39;</span><span class="p">,</span> <span class="s1">&#39;december&#39;</span><span class="p">]</span>
<span class="n">_daynames</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mon&#39;</span><span class="p">,</span> <span class="s1">&#39;tue&#39;</span><span class="p">,</span> <span class="s1">&#39;wed&#39;</span><span class="p">,</span> <span class="s1">&#39;thu&#39;</span><span class="p">,</span> <span class="s1">&#39;fri&#39;</span><span class="p">,</span> <span class="s1">&#39;sat&#39;</span><span class="p">,</span> <span class="s1">&#39;sun&#39;</span><span class="p">]</span>

<span class="c1"># The timezone table does not include the military time zones defined</span>
<span class="c1"># in RFC822, other than Z.  According to RFC1123, the description in</span>
<span class="c1"># RFC822 gets the signs wrong, so we can&#39;t rely on any such time</span>
<span class="c1"># zones.  RFC1123 recommends that numeric timezone indicators be used</span>
<span class="c1"># instead of timezone names.</span>

<span class="n">_timezones</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;UT&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;UTC&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;GMT&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
              <span class="s1">&#39;AST&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">400</span><span class="p">,</span> <span class="s1">&#39;ADT&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">300</span><span class="p">,</span>  <span class="c1"># Atlantic (used in Canada)</span>
              <span class="s1">&#39;EST&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;EDT&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">400</span><span class="p">,</span>  <span class="c1"># Eastern</span>
              <span class="s1">&#39;CST&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">600</span><span class="p">,</span> <span class="s1">&#39;CDT&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">500</span><span class="p">,</span>  <span class="c1"># Central</span>
              <span class="s1">&#39;MST&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">700</span><span class="p">,</span> <span class="s1">&#39;MDT&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">600</span><span class="p">,</span>  <span class="c1"># Mountain</span>
              <span class="s1">&#39;PST&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">800</span><span class="p">,</span> <span class="s1">&#39;PDT&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">700</span>   <span class="c1"># Pacific</span>
              <span class="p">}</span>


<div class="viewcode-block" id="parsedate_tz"><a class="viewcode-back" href="../generated/rfc822.parsedate_tz.html#rfc822.parsedate_tz">[docs]</a><span class="k">def</span> <span class="nf">parsedate_tz</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert a date string to a time tuple.</span>

<span class="sd">    Accounts for military timezones.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">_daynames</span><span class="p">:</span>
        <span class="c1"># There&#39;s a dayname here. Skip it</span>
        <span class="k">del</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># no space after the &quot;weekday,&quot;?</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span> <span class="c1"># RFC 850 date, deprecated</span>
        <span class="n">stuff</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stuff</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">stuff</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="p">[:</span><span class="n">i</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="c1"># Dummy tz</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
    <span class="p">[</span><span class="n">dd</span><span class="p">,</span> <span class="n">mm</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">tm</span><span class="p">,</span> <span class="n">tz</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">mm</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">mm</span> <span class="ow">in</span> <span class="n">_monthnames</span><span class="p">:</span>
        <span class="n">dd</span><span class="p">,</span> <span class="n">mm</span> <span class="o">=</span> <span class="n">mm</span><span class="p">,</span> <span class="n">dd</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">mm</span> <span class="ow">in</span> <span class="n">_monthnames</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
    <span class="n">mm</span> <span class="o">=</span> <span class="n">_monthnames</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">mm</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">mm</span> <span class="o">&gt;</span> <span class="mi">12</span><span class="p">:</span> <span class="n">mm</span> <span class="o">=</span> <span class="n">mm</span> <span class="o">-</span> <span class="mi">12</span>
    <span class="k">if</span> <span class="n">dd</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;,&#39;</span><span class="p">:</span>
        <span class="n">dd</span> <span class="o">=</span> <span class="n">dd</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">yy</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">yy</span><span class="p">,</span> <span class="n">tm</span> <span class="o">=</span> <span class="n">tm</span><span class="p">,</span> <span class="n">yy</span>
    <span class="k">if</span> <span class="n">yy</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;,&#39;</span><span class="p">:</span>
        <span class="n">yy</span> <span class="o">=</span> <span class="n">yy</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">yy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
        <span class="n">yy</span><span class="p">,</span> <span class="n">tz</span> <span class="o">=</span> <span class="n">tz</span><span class="p">,</span> <span class="n">yy</span>
    <span class="k">if</span> <span class="n">tm</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;,&#39;</span><span class="p">:</span>
        <span class="n">tm</span> <span class="o">=</span> <span class="n">tm</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">tm</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tm</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="p">[</span><span class="n">thh</span><span class="p">,</span> <span class="n">tmm</span><span class="p">]</span> <span class="o">=</span> <span class="n">tm</span>
        <span class="n">tss</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">tm</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="p">[</span><span class="n">thh</span><span class="p">,</span> <span class="n">tmm</span><span class="p">,</span> <span class="n">tss</span><span class="p">]</span> <span class="o">=</span> <span class="n">tm</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">yy</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">yy</span><span class="p">)</span>
        <span class="n">dd</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
        <span class="n">thh</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">thh</span><span class="p">)</span>
        <span class="n">tmm</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tmm</span><span class="p">)</span>
        <span class="n">tss</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tss</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="n">tzoffset</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">tz</span> <span class="o">=</span> <span class="n">tz</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">tz</span> <span class="ow">in</span> <span class="n">_timezones</span><span class="p">:</span>
        <span class="n">tzoffset</span> <span class="o">=</span> <span class="n">_timezones</span><span class="p">[</span><span class="n">tz</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">tzoffset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tz</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="c1"># Convert a timezone offset into seconds ; -0500 -&gt; -18000</span>
    <span class="k">if</span> <span class="n">tzoffset</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">tzoffset</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">tzsign</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">tzoffset</span> <span class="o">=</span> <span class="o">-</span><span class="n">tzoffset</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tzsign</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">tzoffset</span> <span class="o">=</span> <span class="n">tzsign</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="n">tzoffset</span><span class="o">//</span><span class="mi">100</span><span class="p">)</span><span class="o">*</span><span class="mi">3600</span> <span class="o">+</span> <span class="p">(</span><span class="n">tzoffset</span> <span class="o">%</span> <span class="mi">100</span><span class="p">)</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">yy</span><span class="p">,</span> <span class="n">mm</span><span class="p">,</span> <span class="n">dd</span><span class="p">,</span> <span class="n">thh</span><span class="p">,</span> <span class="n">tmm</span><span class="p">,</span> <span class="n">tss</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tzoffset</span><span class="p">)</span></div>


<div class="viewcode-block" id="parsedate"><a class="viewcode-back" href="../generated/rfc822.parsedate.html#rfc822.parsedate">[docs]</a><span class="k">def</span> <span class="nf">parsedate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert a time string to a time tuple.&quot;&quot;&quot;</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">parsedate_tz</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">t</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">t</span>
    <span class="k">return</span> <span class="n">t</span><span class="p">[:</span><span class="mi">9</span><span class="p">]</span></div>


<div class="viewcode-block" id="mktime_tz"><a class="viewcode-back" href="../generated/rfc822.mktime_tz.html#rfc822.mktime_tz">[docs]</a><span class="k">def</span> <span class="nf">mktime_tz</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Turn a 10-tuple as returned by parsedate_tz() into a UTC timestamp.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># No zone info, so localtime is better assumption than GMT</span>
        <span class="k">return</span> <span class="n">time</span><span class="o">.</span><span class="n">mktime</span><span class="p">(</span><span class="n">data</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">mktime</span><span class="p">(</span><span class="n">data</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
        <span class="k">return</span> <span class="n">t</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">-</span> <span class="n">time</span><span class="o">.</span><span class="n">timezone</span></div>

<div class="viewcode-block" id="formatdate"><a class="viewcode-back" href="../generated/rfc822.formatdate.html#rfc822.formatdate">[docs]</a><span class="k">def</span> <span class="nf">formatdate</span><span class="p">(</span><span class="n">timeval</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns time format preferred for Internet standards.</span>

<span class="sd">    Sun, 06 Nov 1994 08:49:37 GMT  ; RFC 822, updated by RFC 1123</span>

<span class="sd">    According to RFC 1123, day and month names must always be in</span>
<span class="sd">    English.  If not for that, this code could use strftime().  It</span>
<span class="sd">    can&#39;t because strftime() honors the locale and could generate</span>
<span class="sd">    non-English names.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">timeval</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">timeval</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">timeval</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">gmtime</span><span class="p">(</span><span class="n">timeval</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">, </span><span class="si">%02d</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> </span><span class="si">%04d</span><span class="s2"> </span><span class="si">%02d</span><span class="s2">:</span><span class="si">%02d</span><span class="s2">:</span><span class="si">%02d</span><span class="s2"> GMT&quot;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;Mon&quot;</span><span class="p">,</span> <span class="s2">&quot;Tue&quot;</span><span class="p">,</span> <span class="s2">&quot;Wed&quot;</span><span class="p">,</span> <span class="s2">&quot;Thu&quot;</span><span class="p">,</span> <span class="s2">&quot;Fri&quot;</span><span class="p">,</span> <span class="s2">&quot;Sat&quot;</span><span class="p">,</span> <span class="s2">&quot;Sun&quot;</span><span class="p">)[</span><span class="n">timeval</span><span class="p">[</span><span class="mi">6</span><span class="p">]],</span>
            <span class="n">timeval</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="p">(</span><span class="s2">&quot;Jan&quot;</span><span class="p">,</span> <span class="s2">&quot;Feb&quot;</span><span class="p">,</span> <span class="s2">&quot;Mar&quot;</span><span class="p">,</span> <span class="s2">&quot;Apr&quot;</span><span class="p">,</span> <span class="s2">&quot;May&quot;</span><span class="p">,</span> <span class="s2">&quot;Jun&quot;</span><span class="p">,</span>
             <span class="s2">&quot;Jul&quot;</span><span class="p">,</span> <span class="s2">&quot;Aug&quot;</span><span class="p">,</span> <span class="s2">&quot;Sep&quot;</span><span class="p">,</span> <span class="s2">&quot;Oct&quot;</span><span class="p">,</span> <span class="s2">&quot;Nov&quot;</span><span class="p">,</span> <span class="s2">&quot;Dec&quot;</span><span class="p">)[</span><span class="n">timeval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                <span class="n">timeval</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">timeval</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">timeval</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">timeval</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span></div>


<span class="c1"># When used as script, run a small test program.</span>
<span class="c1"># The first command line argument must be a filename containing one</span>
<span class="c1"># message in RFC-822 format.</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span>
    <span class="nb">file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">],</span> <span class="s1">&#39;Mail/inbox/1&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span> <span class="nb">file</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">print</span> <span class="s1">&#39;From:&#39;</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">getaddr</span><span class="p">(</span><span class="s1">&#39;from&#39;</span><span class="p">)</span>
    <span class="k">print</span> <span class="s1">&#39;To:&#39;</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">getaddrlist</span><span class="p">(</span><span class="s1">&#39;to&#39;</span><span class="p">)</span>
    <span class="k">print</span> <span class="s1">&#39;Subject:&#39;</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="s1">&#39;subject&#39;</span><span class="p">)</span>
    <span class="k">print</span> <span class="s1">&#39;Date:&#39;</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">)</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">getdate_tz</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">)</span>
    <span class="n">tz</span> <span class="o">=</span> <span class="n">date</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">(</span><span class="n">mktime_tz</span><span class="p">(</span><span class="n">date</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">date</span><span class="p">:</span>
        <span class="k">print</span> <span class="s1">&#39;ParsedDate:&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">asctime</span><span class="p">(</span><span class="n">date</span><span class="p">),</span>
        <span class="n">hhmmss</span> <span class="o">=</span> <span class="n">tz</span>
        <span class="n">hhmm</span><span class="p">,</span> <span class="n">ss</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">hhmmss</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
        <span class="n">hh</span><span class="p">,</span> <span class="n">mm</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">hhmm</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
        <span class="k">print</span> <span class="s2">&quot;</span><span class="si">%+03d%02d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">hh</span><span class="p">,</span> <span class="n">mm</span><span class="p">),</span>
        <span class="k">if</span> <span class="n">ss</span><span class="p">:</span> <span class="k">print</span> <span class="s2">&quot;.</span><span class="si">%02d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ss</span><span class="p">,</span>
        <span class="k">print</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="s1">&#39;ParsedDate:&#39;</span><span class="p">,</span> <span class="bp">None</span>
    <span class="n">m</span><span class="o">.</span><span class="n">rewindbody</span><span class="p">()</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">():</span>
        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">print</span> <span class="s1">&#39;Lines:&#39;</span><span class="p">,</span> <span class="n">n</span>
    <span class="k">print</span> <span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">70</span>
    <span class="k">print</span> <span class="s1">&#39;len =&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;Date&#39;</span> <span class="ow">in</span> <span class="n">m</span><span class="p">:</span> <span class="k">print</span> <span class="s1">&#39;Date =&#39;</span><span class="p">,</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s1">&#39;X-Nonsense&#39;</span> <span class="ow">in</span> <span class="n">m</span><span class="p">:</span> <span class="k">pass</span>
    <span class="k">print</span> <span class="s1">&#39;keys =&#39;</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="k">print</span> <span class="s1">&#39;values =&#39;</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="k">print</span> <span class="s1">&#39;items =&#39;</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/copybutton.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>