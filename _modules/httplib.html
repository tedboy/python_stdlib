

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>httplib &mdash; Python Standard Library</title>
  

  
  
    <link rel="shortcut icon" href="../_static/py.png"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Python Standard Library" href="../index.html"/>
        <link rel="up" title="Module code" href="index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Python Standard Library
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../01to10.html">Ch 01 - 10</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11to20.html">Ch 11 - 20</a></li>
<li class="toctree-l1"><a class="reference internal" href="../21to30.html">Ch 21 - 30</a></li>
<li class="toctree-l1"><a class="reference internal" href="../31to37.html">Ch 31 - 37</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_all.html">api</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Python Standard Library</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          













<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Module code</a> &raquo;</li>
        
      <li>httplib</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for httplib</h1><div class="highlight"><pre>
<span></span><span class="sd">r&quot;&quot;&quot;HTTP/1.1 client library</span>

<span class="sd">&lt;intro stuff goes here&gt;</span>
<span class="sd">&lt;other stuff, too&gt;</span>

<span class="sd">HTTPConnection goes through a number of &quot;states&quot;, which define when a client</span>
<span class="sd">may legally make another request or fetch the response for a particular</span>
<span class="sd">request. This diagram details these state transitions:</span>

<span class="sd">    (null)</span>
<span class="sd">      |</span>
<span class="sd">      | HTTPConnection()</span>
<span class="sd">      v</span>
<span class="sd">    Idle</span>
<span class="sd">      |</span>
<span class="sd">      | putrequest()</span>
<span class="sd">      v</span>
<span class="sd">    Request-started</span>
<span class="sd">      |</span>
<span class="sd">      | ( putheader() )*  endheaders()</span>
<span class="sd">      v</span>
<span class="sd">    Request-sent</span>
<span class="sd">      |</span>
<span class="sd">      | response = getresponse()</span>
<span class="sd">      v</span>
<span class="sd">    Unread-response   [Response-headers-read]</span>
<span class="sd">      |\____________________</span>
<span class="sd">      |                     |</span>
<span class="sd">      | response.read()     | putrequest()</span>
<span class="sd">      v                     v</span>
<span class="sd">    Idle                  Req-started-unread-response</span>
<span class="sd">                     ______/|</span>
<span class="sd">                   /        |</span>
<span class="sd">   response.read() |        | ( putheader() )*  endheaders()</span>
<span class="sd">                   v        v</span>
<span class="sd">       Request-started    Req-sent-unread-response</span>
<span class="sd">                            |</span>
<span class="sd">                            | response.read()</span>
<span class="sd">                            v</span>
<span class="sd">                          Request-sent</span>

<span class="sd">This diagram presents the following rules:</span>
<span class="sd">  -- a second request may not be started until {response-headers-read}</span>
<span class="sd">  -- a response [object] cannot be retrieved until {request-sent}</span>
<span class="sd">  -- there is no differentiation between an unread response body and a</span>
<span class="sd">     partially read response body</span>

<span class="sd">Note: this enforcement is applied by the HTTPConnection class. The</span>
<span class="sd">      HTTPResponse class does not enforce this state machine, which</span>
<span class="sd">      implies sophisticated clients may accelerate the request/response</span>
<span class="sd">      pipeline. Caution should be taken, though: accelerating the states</span>
<span class="sd">      beyond the above pattern may imply knowledge of the server&#39;s</span>
<span class="sd">      connection-close behavior for certain requests. For example, it</span>
<span class="sd">      is impossible to tell whether the server will close the connection</span>
<span class="sd">      UNTIL the response headers have been read; this means that further</span>
<span class="sd">      requests cannot be placed into the pipeline until it is known that</span>
<span class="sd">      the server will NOT be closing the connection.</span>

<span class="sd">Logical State                  __state            __response</span>
<span class="sd">-------------                  -------            ----------</span>
<span class="sd">Idle                           _CS_IDLE           None</span>
<span class="sd">Request-started                _CS_REQ_STARTED    None</span>
<span class="sd">Request-sent                   _CS_REQ_SENT       None</span>
<span class="sd">Unread-response                _CS_IDLE           &lt;response_class&gt;</span>
<span class="sd">Req-started-unread-response    _CS_REQ_STARTED    &lt;response_class&gt;</span>
<span class="sd">Req-sent-unread-response       _CS_REQ_SENT       &lt;response_class&gt;</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">array</span> <span class="kn">import</span> <span class="n">array</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">py3kwarning</span>
<span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urlsplit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">py3kwarning</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="s2">&quot;.*mimetools has been removed&quot;</span><span class="p">,</span>
                                <span class="ne">DeprecationWarning</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">mimetools</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">cStringIO</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">StringIO</span> <span class="kn">import</span> <span class="n">StringIO</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;HTTP&quot;</span><span class="p">,</span> <span class="s2">&quot;HTTPResponse&quot;</span><span class="p">,</span> <span class="s2">&quot;HTTPConnection&quot;</span><span class="p">,</span>
           <span class="s2">&quot;HTTPException&quot;</span><span class="p">,</span> <span class="s2">&quot;NotConnected&quot;</span><span class="p">,</span> <span class="s2">&quot;UnknownProtocol&quot;</span><span class="p">,</span>
           <span class="s2">&quot;UnknownTransferEncoding&quot;</span><span class="p">,</span> <span class="s2">&quot;UnimplementedFileMode&quot;</span><span class="p">,</span>
           <span class="s2">&quot;IncompleteRead&quot;</span><span class="p">,</span> <span class="s2">&quot;InvalidURL&quot;</span><span class="p">,</span> <span class="s2">&quot;ImproperConnectionState&quot;</span><span class="p">,</span>
           <span class="s2">&quot;CannotSendRequest&quot;</span><span class="p">,</span> <span class="s2">&quot;CannotSendHeader&quot;</span><span class="p">,</span> <span class="s2">&quot;ResponseNotReady&quot;</span><span class="p">,</span>
           <span class="s2">&quot;BadStatusLine&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="s2">&quot;responses&quot;</span><span class="p">]</span>

<span class="n">HTTP_PORT</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">HTTPS_PORT</span> <span class="o">=</span> <span class="mi">443</span>

<span class="n">_UNKNOWN</span> <span class="o">=</span> <span class="s1">&#39;UNKNOWN&#39;</span>

<span class="c1"># connection states</span>
<span class="n">_CS_IDLE</span> <span class="o">=</span> <span class="s1">&#39;Idle&#39;</span>
<span class="n">_CS_REQ_STARTED</span> <span class="o">=</span> <span class="s1">&#39;Request-started&#39;</span>
<span class="n">_CS_REQ_SENT</span> <span class="o">=</span> <span class="s1">&#39;Request-sent&#39;</span>

<span class="c1"># status codes</span>
<span class="c1"># informational</span>
<span class="n">CONTINUE</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">SWITCHING_PROTOCOLS</span> <span class="o">=</span> <span class="mi">101</span>
<span class="n">PROCESSING</span> <span class="o">=</span> <span class="mi">102</span>

<span class="c1"># successful</span>
<span class="n">OK</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">CREATED</span> <span class="o">=</span> <span class="mi">201</span>
<span class="n">ACCEPTED</span> <span class="o">=</span> <span class="mi">202</span>
<span class="n">NON_AUTHORITATIVE_INFORMATION</span> <span class="o">=</span> <span class="mi">203</span>
<span class="n">NO_CONTENT</span> <span class="o">=</span> <span class="mi">204</span>
<span class="n">RESET_CONTENT</span> <span class="o">=</span> <span class="mi">205</span>
<span class="n">PARTIAL_CONTENT</span> <span class="o">=</span> <span class="mi">206</span>
<span class="n">MULTI_STATUS</span> <span class="o">=</span> <span class="mi">207</span>
<span class="n">IM_USED</span> <span class="o">=</span> <span class="mi">226</span>

<span class="c1"># redirection</span>
<span class="n">MULTIPLE_CHOICES</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">MOVED_PERMANENTLY</span> <span class="o">=</span> <span class="mi">301</span>
<span class="n">FOUND</span> <span class="o">=</span> <span class="mi">302</span>
<span class="n">SEE_OTHER</span> <span class="o">=</span> <span class="mi">303</span>
<span class="n">NOT_MODIFIED</span> <span class="o">=</span> <span class="mi">304</span>
<span class="n">USE_PROXY</span> <span class="o">=</span> <span class="mi">305</span>
<span class="n">TEMPORARY_REDIRECT</span> <span class="o">=</span> <span class="mi">307</span>

<span class="c1"># client error</span>
<span class="n">BAD_REQUEST</span> <span class="o">=</span> <span class="mi">400</span>
<span class="n">UNAUTHORIZED</span> <span class="o">=</span> <span class="mi">401</span>
<span class="n">PAYMENT_REQUIRED</span> <span class="o">=</span> <span class="mi">402</span>
<span class="n">FORBIDDEN</span> <span class="o">=</span> <span class="mi">403</span>
<span class="n">NOT_FOUND</span> <span class="o">=</span> <span class="mi">404</span>
<span class="n">METHOD_NOT_ALLOWED</span> <span class="o">=</span> <span class="mi">405</span>
<span class="n">NOT_ACCEPTABLE</span> <span class="o">=</span> <span class="mi">406</span>
<span class="n">PROXY_AUTHENTICATION_REQUIRED</span> <span class="o">=</span> <span class="mi">407</span>
<span class="n">REQUEST_TIMEOUT</span> <span class="o">=</span> <span class="mi">408</span>
<span class="n">CONFLICT</span> <span class="o">=</span> <span class="mi">409</span>
<span class="n">GONE</span> <span class="o">=</span> <span class="mi">410</span>
<span class="n">LENGTH_REQUIRED</span> <span class="o">=</span> <span class="mi">411</span>
<span class="n">PRECONDITION_FAILED</span> <span class="o">=</span> <span class="mi">412</span>
<span class="n">REQUEST_ENTITY_TOO_LARGE</span> <span class="o">=</span> <span class="mi">413</span>
<span class="n">REQUEST_URI_TOO_LONG</span> <span class="o">=</span> <span class="mi">414</span>
<span class="n">UNSUPPORTED_MEDIA_TYPE</span> <span class="o">=</span> <span class="mi">415</span>
<span class="n">REQUESTED_RANGE_NOT_SATISFIABLE</span> <span class="o">=</span> <span class="mi">416</span>
<span class="n">EXPECTATION_FAILED</span> <span class="o">=</span> <span class="mi">417</span>
<span class="n">UNPROCESSABLE_ENTITY</span> <span class="o">=</span> <span class="mi">422</span>
<span class="n">LOCKED</span> <span class="o">=</span> <span class="mi">423</span>
<span class="n">FAILED_DEPENDENCY</span> <span class="o">=</span> <span class="mi">424</span>
<span class="n">UPGRADE_REQUIRED</span> <span class="o">=</span> <span class="mi">426</span>

<span class="c1"># server error</span>
<span class="n">INTERNAL_SERVER_ERROR</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">NOT_IMPLEMENTED</span> <span class="o">=</span> <span class="mi">501</span>
<span class="n">BAD_GATEWAY</span> <span class="o">=</span> <span class="mi">502</span>
<span class="n">SERVICE_UNAVAILABLE</span> <span class="o">=</span> <span class="mi">503</span>
<span class="n">GATEWAY_TIMEOUT</span> <span class="o">=</span> <span class="mi">504</span>
<span class="n">HTTP_VERSION_NOT_SUPPORTED</span> <span class="o">=</span> <span class="mi">505</span>
<span class="n">INSUFFICIENT_STORAGE</span> <span class="o">=</span> <span class="mi">507</span>
<span class="n">NOT_EXTENDED</span> <span class="o">=</span> <span class="mi">510</span>

<span class="c1"># Mapping status codes to official W3C names</span>
<span class="n">responses</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">100</span><span class="p">:</span> <span class="s1">&#39;Continue&#39;</span><span class="p">,</span>
    <span class="mi">101</span><span class="p">:</span> <span class="s1">&#39;Switching Protocols&#39;</span><span class="p">,</span>

    <span class="mi">200</span><span class="p">:</span> <span class="s1">&#39;OK&#39;</span><span class="p">,</span>
    <span class="mi">201</span><span class="p">:</span> <span class="s1">&#39;Created&#39;</span><span class="p">,</span>
    <span class="mi">202</span><span class="p">:</span> <span class="s1">&#39;Accepted&#39;</span><span class="p">,</span>
    <span class="mi">203</span><span class="p">:</span> <span class="s1">&#39;Non-Authoritative Information&#39;</span><span class="p">,</span>
    <span class="mi">204</span><span class="p">:</span> <span class="s1">&#39;No Content&#39;</span><span class="p">,</span>
    <span class="mi">205</span><span class="p">:</span> <span class="s1">&#39;Reset Content&#39;</span><span class="p">,</span>
    <span class="mi">206</span><span class="p">:</span> <span class="s1">&#39;Partial Content&#39;</span><span class="p">,</span>

    <span class="mi">300</span><span class="p">:</span> <span class="s1">&#39;Multiple Choices&#39;</span><span class="p">,</span>
    <span class="mi">301</span><span class="p">:</span> <span class="s1">&#39;Moved Permanently&#39;</span><span class="p">,</span>
    <span class="mi">302</span><span class="p">:</span> <span class="s1">&#39;Found&#39;</span><span class="p">,</span>
    <span class="mi">303</span><span class="p">:</span> <span class="s1">&#39;See Other&#39;</span><span class="p">,</span>
    <span class="mi">304</span><span class="p">:</span> <span class="s1">&#39;Not Modified&#39;</span><span class="p">,</span>
    <span class="mi">305</span><span class="p">:</span> <span class="s1">&#39;Use Proxy&#39;</span><span class="p">,</span>
    <span class="mi">306</span><span class="p">:</span> <span class="s1">&#39;(Unused)&#39;</span><span class="p">,</span>
    <span class="mi">307</span><span class="p">:</span> <span class="s1">&#39;Temporary Redirect&#39;</span><span class="p">,</span>

    <span class="mi">400</span><span class="p">:</span> <span class="s1">&#39;Bad Request&#39;</span><span class="p">,</span>
    <span class="mi">401</span><span class="p">:</span> <span class="s1">&#39;Unauthorized&#39;</span><span class="p">,</span>
    <span class="mi">402</span><span class="p">:</span> <span class="s1">&#39;Payment Required&#39;</span><span class="p">,</span>
    <span class="mi">403</span><span class="p">:</span> <span class="s1">&#39;Forbidden&#39;</span><span class="p">,</span>
    <span class="mi">404</span><span class="p">:</span> <span class="s1">&#39;Not Found&#39;</span><span class="p">,</span>
    <span class="mi">405</span><span class="p">:</span> <span class="s1">&#39;Method Not Allowed&#39;</span><span class="p">,</span>
    <span class="mi">406</span><span class="p">:</span> <span class="s1">&#39;Not Acceptable&#39;</span><span class="p">,</span>
    <span class="mi">407</span><span class="p">:</span> <span class="s1">&#39;Proxy Authentication Required&#39;</span><span class="p">,</span>
    <span class="mi">408</span><span class="p">:</span> <span class="s1">&#39;Request Timeout&#39;</span><span class="p">,</span>
    <span class="mi">409</span><span class="p">:</span> <span class="s1">&#39;Conflict&#39;</span><span class="p">,</span>
    <span class="mi">410</span><span class="p">:</span> <span class="s1">&#39;Gone&#39;</span><span class="p">,</span>
    <span class="mi">411</span><span class="p">:</span> <span class="s1">&#39;Length Required&#39;</span><span class="p">,</span>
    <span class="mi">412</span><span class="p">:</span> <span class="s1">&#39;Precondition Failed&#39;</span><span class="p">,</span>
    <span class="mi">413</span><span class="p">:</span> <span class="s1">&#39;Request Entity Too Large&#39;</span><span class="p">,</span>
    <span class="mi">414</span><span class="p">:</span> <span class="s1">&#39;Request-URI Too Long&#39;</span><span class="p">,</span>
    <span class="mi">415</span><span class="p">:</span> <span class="s1">&#39;Unsupported Media Type&#39;</span><span class="p">,</span>
    <span class="mi">416</span><span class="p">:</span> <span class="s1">&#39;Requested Range Not Satisfiable&#39;</span><span class="p">,</span>
    <span class="mi">417</span><span class="p">:</span> <span class="s1">&#39;Expectation Failed&#39;</span><span class="p">,</span>

    <span class="mi">500</span><span class="p">:</span> <span class="s1">&#39;Internal Server Error&#39;</span><span class="p">,</span>
    <span class="mi">501</span><span class="p">:</span> <span class="s1">&#39;Not Implemented&#39;</span><span class="p">,</span>
    <span class="mi">502</span><span class="p">:</span> <span class="s1">&#39;Bad Gateway&#39;</span><span class="p">,</span>
    <span class="mi">503</span><span class="p">:</span> <span class="s1">&#39;Service Unavailable&#39;</span><span class="p">,</span>
    <span class="mi">504</span><span class="p">:</span> <span class="s1">&#39;Gateway Timeout&#39;</span><span class="p">,</span>
    <span class="mi">505</span><span class="p">:</span> <span class="s1">&#39;HTTP Version Not Supported&#39;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># maximal amount of data to read at one time in _safe_read</span>
<span class="n">MAXAMOUNT</span> <span class="o">=</span> <span class="mi">1048576</span>

<span class="c1"># maximal line length when calling readline().</span>
<span class="n">_MAXLINE</span> <span class="o">=</span> <span class="mi">65536</span>

<span class="c1"># maximum amount of headers accepted</span>
<span class="n">_MAXHEADERS</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Header name/value ABNF (http://tools.ietf.org/html/rfc7230#section-3.2)</span>
<span class="c1">#</span>
<span class="c1"># VCHAR          = %x21-7E</span>
<span class="c1"># obs-text       = %x80-FF</span>
<span class="c1"># header-field   = field-name &quot;:&quot; OWS field-value OWS</span>
<span class="c1"># field-name     = token</span>
<span class="c1"># field-value    = *( field-content / obs-fold )</span>
<span class="c1"># field-content  = field-vchar [ 1*( SP / HTAB ) field-vchar ]</span>
<span class="c1"># field-vchar    = VCHAR / obs-text</span>
<span class="c1">#</span>
<span class="c1"># obs-fold       = CRLF 1*( SP / HTAB )</span>
<span class="c1">#                ; obsolete line folding</span>
<span class="c1">#                ; see Section 3.2.4</span>

<span class="c1"># token          = 1*tchar</span>
<span class="c1">#</span>
<span class="c1"># tchar          = &quot;!&quot; / &quot;#&quot; / &quot;$&quot; / &quot;%&quot; / &quot;&amp;&quot; / &quot;&#39;&quot; / &quot;*&quot;</span>
<span class="c1">#                / &quot;+&quot; / &quot;-&quot; / &quot;.&quot; / &quot;^&quot; / &quot;_&quot; / &quot;`&quot; / &quot;|&quot; / &quot;~&quot;</span>
<span class="c1">#                / DIGIT / ALPHA</span>
<span class="c1">#                ; any VCHAR, except delimiters</span>
<span class="c1">#</span>
<span class="c1"># VCHAR defined in http://tools.ietf.org/html/rfc5234#appendix-B.1</span>

<span class="c1"># the patterns for both name and value are more leniant than RFC</span>
<span class="c1"># definitions to allow for backwards compatibility</span>
<span class="n">_is_legal_header_name</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">r&#39;\A[^:\s][^:\r\n]*\Z&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">match</span>
<span class="n">_is_illegal_header_value</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">r&#39;\n(?![ \t])|\r(?![ \t\n])&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">search</span>

<span class="c1"># We always set the Content-Length header for these methods because some</span>
<span class="c1"># servers will otherwise respond with a 411</span>
<span class="n">_METHODS_EXPECTING_BODY</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;PATCH&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span> <span class="s1">&#39;PUT&#39;</span><span class="p">}</span>


<div class="viewcode-block" id="HTTPMessage"><a class="viewcode-back" href="../generated/generated/httplib.HTTPMessage.html#httplib.HTTPMessage">[docs]</a><span class="k">class</span> <span class="nc">HTTPMessage</span><span class="p">(</span><span class="n">mimetools</span><span class="o">.</span><span class="n">Message</span><span class="p">):</span>

<div class="viewcode-block" id="HTTPMessage.addheader"><a class="viewcode-back" href="../generated/generated/httplib.HTTPMessage.addheader.html#httplib.HTTPMessage.addheader">[docs]</a>    <span class="k">def</span> <span class="nf">addheader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add header for field key handling repeats.&quot;&quot;&quot;</span>
        <span class="n">prev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">prev</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">combined</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">prev</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">combined</span></div>

<div class="viewcode-block" id="HTTPMessage.addcontinue"><a class="viewcode-back" href="../generated/generated/httplib.HTTPMessage.addcontinue.html#httplib.HTTPMessage.addcontinue">[docs]</a>    <span class="k">def</span> <span class="nf">addcontinue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">more</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add more field data from a continuation line.&quot;&quot;&quot;</span>
        <span class="n">prev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">prev</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span> <span class="o">+</span> <span class="n">more</span></div>

<div class="viewcode-block" id="HTTPMessage.readheaders"><a class="viewcode-back" href="../generated/generated/httplib.HTTPMessage.readheaders.html#httplib.HTTPMessage.readheaders">[docs]</a>    <span class="k">def</span> <span class="nf">readheaders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read header lines.</span>

<span class="sd">        Read header lines up to the entirely blank line that terminates them.</span>
<span class="sd">        The (normally blank) line that ends the headers is skipped, but not</span>
<span class="sd">        included in the returned list.  If a non-header line ends the headers,</span>
<span class="sd">        (which is an error), an attempt is made to backspace over it; it is</span>
<span class="sd">        never included in the returned list.</span>

<span class="sd">        The variable self.status is set to the empty string if all went well,</span>
<span class="sd">        otherwise it is an error message.  The variable self.headers is a</span>
<span class="sd">        completely uninterpreted list of lines contained in the header (so</span>
<span class="sd">        printing them will reproduce the header exactly as it appears in the</span>
<span class="sd">        file).</span>

<span class="sd">        If multiple header fields with the same name occur, they are combined</span>
<span class="sd">        according to the rules in RFC 2616 sec 4.2:</span>

<span class="sd">        Appending each subsequent field-value to the first, each separated</span>
<span class="sd">        by a comma. The order in which header fields with the same field-name</span>
<span class="sd">        are received is significant to the interpretation of the combined</span>
<span class="sd">        field value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># XXX The implementation overrides the readheaders() method of</span>
        <span class="c1"># rfc822.Message.  The base class design isn&#39;t amenable to</span>
        <span class="c1"># customized behavior here so the method here is a copy of the</span>
        <span class="c1"># base class code with a few small changes.</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unixfrom</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="n">hlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">headerseen</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">firstline</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">startofline</span> <span class="o">=</span> <span class="n">unread</span> <span class="o">=</span> <span class="n">tell</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="p">,</span> <span class="s1">&#39;unread&#39;</span><span class="p">):</span>
            <span class="n">unread</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">unread</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">seekable</span><span class="p">:</span>
            <span class="n">tell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">tell</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hlist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">_MAXHEADERS</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">HTTPException</span><span class="p">(</span><span class="s2">&quot;got more than </span><span class="si">%d</span><span class="s2"> headers&quot;</span> <span class="o">%</span> <span class="n">_MAXHEADERS</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tell</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">startofline</span> <span class="o">=</span> <span class="n">tell</span><span class="p">()</span>
                <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
                    <span class="n">startofline</span> <span class="o">=</span> <span class="n">tell</span> <span class="o">=</span> <span class="bp">None</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">seekable</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">readline</span><span class="p">(</span><span class="n">_MAXLINE</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">_MAXLINE</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">LineTooLong</span><span class="p">(</span><span class="s2">&quot;header line&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;EOF in headers&#39;</span>
                <span class="k">break</span>
            <span class="c1"># Skip unix From name time lines</span>
            <span class="k">if</span> <span class="n">firstline</span> <span class="ow">and</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;From &#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unixfrom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unixfrom</span> <span class="o">+</span> <span class="n">line</span>
                <span class="k">continue</span>
            <span class="n">firstline</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">headerseen</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="s1">&#39; </span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">:</span>
                <span class="c1"># XXX Not sure if continuation lines are handled properly</span>
                <span class="c1"># for http and/or for repeating headers</span>
                <span class="c1"># It&#39;s a continuation line.</span>
                <span class="n">hlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addcontinue</span><span class="p">(</span><span class="n">headerseen</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">iscomment</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
                <span class="c1"># It&#39;s a comment.  Ignore it.</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">islast</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
                <span class="c1"># Note! No pushback here!  The delimiter line gets eaten.</span>
                <span class="k">break</span>
            <span class="n">headerseen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">isheader</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">headerseen</span><span class="p">:</span>
                <span class="c1"># It&#39;s a legal header line, save it.</span>
                <span class="n">hlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addheader</span><span class="p">(</span><span class="n">headerseen</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">headerseen</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="n">headerseen</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c1"># An empty header name. These aren&#39;t allowed in HTTP, but it&#39;s</span>
                <span class="c1"># probably a benign mistake. Don&#39;t add the header, just keep</span>
                <span class="c1"># going.</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># It&#39;s not a header line; throw it back and stop here.</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;No headers&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;Non-header line where header expected&#39;</span>
                <span class="c1"># Try to undo the read.</span>
                <span class="k">if</span> <span class="n">unread</span><span class="p">:</span>
                    <span class="n">unread</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">tell</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">startofline</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">+</span> <span class="s1">&#39;; bad seek&#39;</span>
                <span class="k">break</span></div></div>

<div class="viewcode-block" id="HTTPResponse"><a class="viewcode-back" href="../generated/generated/httplib.HTTPResponse.html#httplib.HTTPResponse">[docs]</a><span class="k">class</span> <span class="nc">HTTPResponse</span><span class="p">:</span>

    <span class="c1"># strict: If true, raise BadStatusLine if the status line can&#39;t be</span>
    <span class="c1"># parsed as a valid HTTP/1.0 or 1.1 status line.  By default it is</span>
    <span class="c1"># false because it prevents clients from talking to HTTP/0.9</span>
    <span class="c1"># servers.  Note that a response with a sufficiently corrupted</span>
    <span class="c1"># status line will look like an HTTP/0.9 response.</span>

    <span class="c1"># See RFC 2616 sec 19.6 and RFC 1945 sec 6 for details.</span>

<div class="viewcode-block" id="HTTPResponse.__init__"><a class="viewcode-back" href="../generated/generated/httplib.HTTPResponse.__init__.html#httplib.HTTPResponse.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sock</span><span class="p">,</span> <span class="n">debuglevel</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">buffering</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">buffering</span><span class="p">:</span>
            <span class="c1"># The caller won&#39;t be using any sock.recv() calls, so buffering</span>
            <span class="c1"># is fine and recommended for performance.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fp</span> <span class="o">=</span> <span class="n">sock</span><span class="o">.</span><span class="n">makefile</span><span class="p">(</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># The buffer size is specified as zero, because the headers of</span>
            <span class="c1"># the response are read with readline().  If the reads were</span>
            <span class="c1"># buffered the readline() calls could consume some of the</span>
            <span class="c1"># response, which make be read via a recv() on the underlying</span>
            <span class="c1"># socket.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fp</span> <span class="o">=</span> <span class="n">sock</span><span class="o">.</span><span class="n">makefile</span><span class="p">(</span><span class="s1">&#39;rb&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debuglevel</span> <span class="o">=</span> <span class="n">debuglevel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">strict</span> <span class="o">=</span> <span class="n">strict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_method</span> <span class="o">=</span> <span class="n">method</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1"># from the Status-Line of the response</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">_UNKNOWN</span> <span class="c1"># HTTP-Version</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">_UNKNOWN</span>  <span class="c1"># Status-Code</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reason</span> <span class="o">=</span> <span class="n">_UNKNOWN</span>  <span class="c1"># Reason-Phrase</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">chunked</span> <span class="o">=</span> <span class="n">_UNKNOWN</span>         <span class="c1"># is &quot;chunked&quot; being used?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chunk_left</span> <span class="o">=</span> <span class="n">_UNKNOWN</span>      <span class="c1"># bytes left to read in current chunk</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="n">_UNKNOWN</span>          <span class="c1"># number of bytes left in response</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">will_close</span> <span class="o">=</span> <span class="n">_UNKNOWN</span>      <span class="c1"># conn will close at end of response</span></div>

<div class="viewcode-block" id="HTTPResponse._read_status"><a class="viewcode-back" href="../generated/generated/httplib.HTTPResponse._read_status.html#httplib.HTTPResponse._read_status">[docs]</a>    <span class="k">def</span> <span class="nf">_read_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Initialize with Simple-Response defaults</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">readline</span><span class="p">(</span><span class="n">_MAXLINE</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">_MAXLINE</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">LineTooLong</span><span class="p">(</span><span class="s2">&quot;header line&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debuglevel</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">print</span> <span class="s2">&quot;reply:&quot;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
            <span class="c1"># Presumably, the server closed the connection before</span>
            <span class="c1"># sending a valid response.</span>
            <span class="k">raise</span> <span class="n">BadStatusLine</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="p">[</span><span class="n">version</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">reason</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="p">[</span><span class="n">version</span><span class="p">,</span> <span class="n">status</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">reason</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="c1"># empty version will cause next test to fail and status</span>
                <span class="c1"># will be treated as 0.9 response.</span>
                <span class="n">version</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">version</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;HTTP/&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="k">raise</span> <span class="n">BadStatusLine</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># assume it&#39;s a Simple-Response from an 0.9 server</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fp</span> <span class="o">=</span> <span class="n">LineAndFileWrapper</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="p">)</span>
                <span class="k">return</span> <span class="s2">&quot;HTTP/0.9&quot;</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>

        <span class="c1"># The status code is a three-digit number</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">status</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">status</span> <span class="o">&lt;</span> <span class="mi">100</span> <span class="ow">or</span> <span class="n">status</span> <span class="o">&gt;</span> <span class="mi">999</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">BadStatusLine</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BadStatusLine</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">version</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">reason</span></div>

<div class="viewcode-block" id="HTTPResponse.begin"><a class="viewcode-back" href="../generated/generated/httplib.HTTPResponse.begin.html#httplib.HTTPResponse.begin">[docs]</a>    <span class="k">def</span> <span class="nf">begin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># we&#39;ve already started reading the response</span>
            <span class="k">return</span>

        <span class="c1"># read until we get a non-100 response</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">version</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">reason</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_status</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">status</span> <span class="o">!=</span> <span class="n">CONTINUE</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="c1"># skip the header from the 100 response</span>
            <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">skip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">readline</span><span class="p">(</span><span class="n">_MAXLINE</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">skip</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">_MAXLINE</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">LineTooLong</span><span class="p">(</span><span class="s2">&quot;header line&quot;</span><span class="p">)</span>
                <span class="n">skip</span> <span class="o">=</span> <span class="n">skip</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">skip</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debuglevel</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">print</span> <span class="s2">&quot;header:&quot;</span><span class="p">,</span> <span class="n">skip</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">status</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reason</span> <span class="o">=</span> <span class="n">reason</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">version</span> <span class="o">==</span> <span class="s1">&#39;HTTP/1.0&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">elif</span> <span class="n">version</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;HTTP/1.&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="mi">11</span>   <span class="c1"># use HTTP/1.1 code for HTTP/1.x where x&gt;=1</span>
        <span class="k">elif</span> <span class="n">version</span> <span class="o">==</span> <span class="s1">&#39;HTTP/0.9&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="mi">9</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">UnknownProtocol</span><span class="p">(</span><span class="n">version</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chunked</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">will_close</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg</span> <span class="o">=</span> <span class="n">HTTPMessage</span><span class="p">(</span><span class="n">StringIO</span><span class="p">())</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span> <span class="o">=</span> <span class="n">HTTPMessage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debuglevel</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">hdr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
                <span class="k">print</span> <span class="s2">&quot;header:&quot;</span><span class="p">,</span> <span class="n">hdr</span><span class="p">,</span>

        <span class="c1"># don&#39;t let the msg keep an fp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">fp</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1"># are we using the chunked-style of transfer encoding?</span>
        <span class="n">tr_enc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="s1">&#39;transfer-encoding&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tr_enc</span> <span class="ow">and</span> <span class="n">tr_enc</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;chunked&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chunked</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chunk_left</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chunked</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># will the connection close at the end of the response?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">will_close</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_close</span><span class="p">()</span>

        <span class="c1"># do we have a Content-Length?</span>
        <span class="c1"># NOTE: RFC 2616, S4.4, #3 says we ignore this if tr_enc is &quot;chunked&quot;</span>
        <span class="n">length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="s1">&#39;content-length&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">length</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">chunked</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># ignore nonsensical negative lengths</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1"># does the body have a fixed length? (of zero)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">==</span> <span class="n">NO_CONTENT</span> <span class="ow">or</span> <span class="n">status</span> <span class="o">==</span> <span class="n">NOT_MODIFIED</span> <span class="ow">or</span>
            <span class="mi">100</span> <span class="o">&lt;=</span> <span class="n">status</span> <span class="o">&lt;</span> <span class="mi">200</span> <span class="ow">or</span>      <span class="c1"># 1xx codes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_method</span> <span class="o">==</span> <span class="s1">&#39;HEAD&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># if the connection remains open, and we aren&#39;t using chunked, and</span>
        <span class="c1"># a content-length was not provided, then assume that the connection</span>
        <span class="c1"># WILL close.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">will_close</span> <span class="ow">and</span> \
           <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">chunked</span> <span class="ow">and</span> \
           <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">will_close</span> <span class="o">=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="HTTPResponse._check_close"><a class="viewcode-back" href="../generated/generated/httplib.HTTPResponse._check_close.html#httplib.HTTPResponse._check_close">[docs]</a>    <span class="k">def</span> <span class="nf">_check_close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">conn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="s1">&#39;connection&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
            <span class="c1"># An HTTP/1.1 proxy is assumed to stay open unless</span>
            <span class="c1"># explicitly closed.</span>
            <span class="n">conn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="s1">&#39;connection&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">conn</span> <span class="ow">and</span> <span class="s2">&quot;close&quot;</span> <span class="ow">in</span> <span class="n">conn</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="k">return</span> <span class="bp">True</span>
            <span class="k">return</span> <span class="bp">False</span>

        <span class="c1"># Some HTTP/1.0 implementations have support for persistent</span>
        <span class="c1"># connections, using rules different than HTTP/1.1.</span>

        <span class="c1"># For older HTTP, Keep-Alive indicates persistent connection.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="s1">&#39;keep-alive&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">False</span>

        <span class="c1"># At least Akamai returns a &quot;Connection: Keep-Alive&quot; header,</span>
        <span class="c1"># which was supposed to be sent by the client.</span>
        <span class="k">if</span> <span class="n">conn</span> <span class="ow">and</span> <span class="s2">&quot;keep-alive&quot;</span> <span class="ow">in</span> <span class="n">conn</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">False</span>

        <span class="c1"># Proxy-Connection is a netscape hack.</span>
        <span class="n">pconn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="s1">&#39;proxy-connection&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pconn</span> <span class="ow">and</span> <span class="s2">&quot;keep-alive&quot;</span> <span class="ow">in</span> <span class="n">pconn</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">False</span>

        <span class="c1"># otherwise, assume it will close</span>
        <span class="k">return</span> <span class="bp">True</span></div>

<div class="viewcode-block" id="HTTPResponse.close"><a class="viewcode-back" href="../generated/generated/httplib.HTTPResponse.close.html#httplib.HTTPResponse.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">fp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fp</span>
        <span class="k">if</span> <span class="n">fp</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fp</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="HTTPResponse.isclosed"><a class="viewcode-back" href="../generated/generated/httplib.HTTPResponse.isclosed.html#httplib.HTTPResponse.isclosed">[docs]</a>    <span class="k">def</span> <span class="nf">isclosed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># NOTE: it is possible that we will not ever call self.close(). This</span>
        <span class="c1">#       case occurs when will_close is TRUE, length is None, and we</span>
        <span class="c1">#       read up to the last byte, but NOT past it.</span>
        <span class="c1">#</span>
        <span class="c1"># IMPLIES: if will_close is FALSE, then self.close() will ALWAYS be</span>
        <span class="c1">#          called, meaning self.isclosed() is meaningful.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fp</span> <span class="ow">is</span> <span class="bp">None</span></div>

    <span class="c1"># XXX It would be nice to have readline and __iter__ for this, too.</span>

<div class="viewcode-block" id="HTTPResponse.read"><a class="viewcode-back" href="../generated/generated/httplib.HTTPResponse.read.html#httplib.HTTPResponse.read">[docs]</a>    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amt</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fp</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_method</span> <span class="o">==</span> <span class="s1">&#39;HEAD&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chunked</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_chunked</span><span class="p">(</span><span class="n">amt</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">amt</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># unbounded read</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_safe_read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">IncompleteRead</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                    <span class="k">raise</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>        <span class="c1"># we read everything</span>
            <span class="k">return</span> <span class="n">s</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">amt</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">:</span>
                <span class="c1"># clip the read to the &quot;end of response&quot;</span>
                <span class="n">amt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span>

        <span class="c1"># we do not use _safe_read() here because this may be a .will_close</span>
        <span class="c1"># connection, and the user is reading more bytes than will be provided</span>
        <span class="c1"># (for example, reading in 1k chunks)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">amt</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span> <span class="ow">and</span> <span class="n">amt</span><span class="p">:</span>
            <span class="c1"># Ideally, we would raise IncompleteRead if the content-length</span>
            <span class="c1"># wasn&#39;t satisfied, but it might break compatibility.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">s</span></div>

<div class="viewcode-block" id="HTTPResponse._read_chunked"><a class="viewcode-back" href="../generated/generated/httplib.HTTPResponse._read_chunked.html#httplib.HTTPResponse._read_chunked">[docs]</a>    <span class="k">def</span> <span class="nf">_read_chunked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amt</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">chunked</span> <span class="o">!=</span> <span class="n">_UNKNOWN</span>
        <span class="n">chunk_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chunk_left</span>
        <span class="n">value</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chunk_left</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">readline</span><span class="p">(</span><span class="n">_MAXLINE</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">_MAXLINE</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">LineTooLong</span><span class="p">(</span><span class="s2">&quot;chunk size&quot;</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="c1"># strip chunk-extensions</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">chunk_left</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="c1"># close the connection as protocol synchronisation is</span>
                    <span class="c1"># probably lost</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                    <span class="k">raise</span> <span class="n">IncompleteRead</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">chunk_left</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">amt</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_safe_read</span><span class="p">(</span><span class="n">chunk_left</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">amt</span> <span class="o">&lt;</span> <span class="n">chunk_left</span><span class="p">:</span>
                <span class="n">value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_safe_read</span><span class="p">(</span><span class="n">amt</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">chunk_left</span> <span class="o">=</span> <span class="n">chunk_left</span> <span class="o">-</span> <span class="n">amt</span>
                <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">amt</span> <span class="o">==</span> <span class="n">chunk_left</span><span class="p">:</span>
                <span class="n">value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_safe_read</span><span class="p">(</span><span class="n">amt</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_safe_read</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># toss the CRLF at the end of the chunk</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">chunk_left</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_safe_read</span><span class="p">(</span><span class="n">chunk_left</span><span class="p">))</span>
                <span class="n">amt</span> <span class="o">-=</span> <span class="n">chunk_left</span>

            <span class="c1"># we read the whole chunk, get another</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_safe_read</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>      <span class="c1"># toss the CRLF at the end of the chunk</span>
            <span class="n">chunk_left</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1"># read and discard trailer up to the CRLF terminator</span>
        <span class="c1">### note: we shouldn&#39;t have any trailers!</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">readline</span><span class="p">(</span><span class="n">_MAXLINE</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">_MAXLINE</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">LineTooLong</span><span class="p">(</span><span class="s2">&quot;trailer line&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
                <span class="c1"># a vanishingly small number of sites EOF without</span>
                <span class="c1"># sending the trailer</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="c1"># we read everything; close the &quot;file&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="HTTPResponse._safe_read"><a class="viewcode-back" href="../generated/generated/httplib.HTTPResponse._safe_read.html#httplib.HTTPResponse._safe_read">[docs]</a>    <span class="k">def</span> <span class="nf">_safe_read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amt</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read the number of bytes requested, compensating for partial reads.</span>

<span class="sd">        Normally, we have a blocking socket, but a read() can be interrupted</span>
<span class="sd">        by a signal (resulting in a partial read).</span>

<span class="sd">        Note that we cannot distinguish between EOF and an interrupt when zero</span>
<span class="sd">        bytes have been read. IncompleteRead() will be raised in this</span>
<span class="sd">        situation.</span>

<span class="sd">        This function should be used when &lt;amt&gt; bytes &quot;should&quot; be present for</span>
<span class="sd">        reading. If the bytes are truly not available (due to EOF), then the</span>
<span class="sd">        IncompleteRead exception can be used to detect the problem.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># NOTE(gps): As of svn r74426 socket._fileobject.read(x) will never</span>
        <span class="c1"># return less than x bytes unless EOF is encountered.  It now handles</span>
        <span class="c1"># signal interruptions (socket.error EINTR) internally.  This code</span>
        <span class="c1"># never caught that exception anyways.  It seems largely pointless.</span>
        <span class="c1"># self.fp.read(amt) will work fine.</span>
        <span class="n">s</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="n">amt</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">chunk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">amt</span><span class="p">,</span> <span class="n">MAXAMOUNT</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">chunk</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">IncompleteRead</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">amt</span><span class="p">)</span>
            <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
            <span class="n">amt</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="HTTPResponse.fileno"><a class="viewcode-back" href="../generated/generated/httplib.HTTPResponse.fileno.html#httplib.HTTPResponse.fileno">[docs]</a>    <span class="k">def</span> <span class="nf">fileno</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">fileno</span><span class="p">()</span></div>

<div class="viewcode-block" id="HTTPResponse.getheader"><a class="viewcode-back" href="../generated/generated/httplib.HTTPResponse.getheader.html#httplib.HTTPResponse.getheader">[docs]</a>    <span class="k">def</span> <span class="nf">getheader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ResponseNotReady</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span></div>

<div class="viewcode-block" id="HTTPResponse.getheaders"><a class="viewcode-back" href="../generated/generated/httplib.HTTPResponse.getheaders.html#httplib.HTTPResponse.getheaders">[docs]</a>    <span class="k">def</span> <span class="nf">getheaders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return list of (header, value) tuples.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ResponseNotReady</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">items</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="HTTPConnection"><a class="viewcode-back" href="../generated/generated/httplib.HTTPConnection.html#httplib.HTTPConnection">[docs]</a><span class="k">class</span> <span class="nc">HTTPConnection</span><span class="p">:</span>

    <span class="n">_http_vsn</span> <span class="o">=</span> <span class="mi">11</span>
    <span class="n">_http_vsn_str</span> <span class="o">=</span> <span class="s1">&#39;HTTP/1.1&#39;</span>

    <span class="n">response_class</span> <span class="o">=</span> <span class="n">HTTPResponse</span>
    <span class="n">default_port</span> <span class="o">=</span> <span class="n">HTTP_PORT</span>
    <span class="n">auto_open</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">debuglevel</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">strict</span> <span class="o">=</span> <span class="mi">0</span>

<div class="viewcode-block" id="HTTPConnection.__init__"><a class="viewcode-back" href="../generated/generated/httplib.HTTPConnection.__init__.html#httplib.HTTPConnection.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">timeout</span><span class="o">=</span><span class="n">socket</span><span class="o">.</span><span class="n">_GLOBAL_DEFAULT_TIMEOUT</span><span class="p">,</span> <span class="n">source_address</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">timeout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_address</span> <span class="o">=</span> <span class="n">source_address</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sock</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__response</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__state</span> <span class="o">=</span> <span class="n">_CS_IDLE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_method</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tunnel_host</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tunnel_port</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tunnel_headers</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">strict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">strict</span> <span class="o">=</span> <span class="n">strict</span>

        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_hostport</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>

        <span class="c1"># This is stored as an instance variable to allow unittests</span>
        <span class="c1"># to replace with a suitable mock</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_connection</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">create_connection</span></div>

<div class="viewcode-block" id="HTTPConnection.set_tunnel"><a class="viewcode-back" href="../generated/generated/httplib.HTTPConnection.set_tunnel.html#httplib.HTTPConnection.set_tunnel">[docs]</a>    <span class="k">def</span> <span class="nf">set_tunnel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Set up host and port for HTTP CONNECT tunnelling.</span>

<span class="sd">        In a connection that uses HTTP Connect tunneling, the host passed to the</span>
<span class="sd">        constructor is used as proxy server that relays all communication to the</span>
<span class="sd">        endpoint passed to set_tunnel. This is done by sending a HTTP CONNECT</span>
<span class="sd">        request to the proxy server when the connection is established.</span>

<span class="sd">        This method must be called before the HTTP connection has been</span>
<span class="sd">        established.</span>

<span class="sd">        The headers argument should be a mapping of extra HTTP headers</span>
<span class="sd">        to send with the CONNECT request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Verify if this is required.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sock</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t setup tunnel for established connection.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_tunnel_host</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tunnel_port</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_hostport</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">headers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tunnel_headers</span> <span class="o">=</span> <span class="n">headers</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tunnel_headers</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>

<div class="viewcode-block" id="HTTPConnection._get_hostport"><a class="viewcode-back" href="../generated/generated/httplib.HTTPConnection._get_hostport.html#httplib.HTTPConnection._get_hostport">[docs]</a>    <span class="k">def</span> <span class="nf">_get_hostport</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">port</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">host</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">host</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>         <span class="c1"># ipv6 addresses have [...]</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">j</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">port</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">host</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:])</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">host</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>  <span class="c1"># http://foo.com:/ == http://foo.com/</span>
                        <span class="n">port</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_port</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">InvalidURL</span><span class="p">(</span><span class="s2">&quot;nonnumeric port: &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">host</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:])</span>
                <span class="n">host</span> <span class="o">=</span> <span class="n">host</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">port</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_port</span>
            <span class="k">if</span> <span class="n">host</span> <span class="ow">and</span> <span class="n">host</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;[&#39;</span> <span class="ow">and</span> <span class="n">host</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;]&#39;</span><span class="p">:</span>
                <span class="n">host</span> <span class="o">=</span> <span class="n">host</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span></div>

<div class="viewcode-block" id="HTTPConnection.set_debuglevel"><a class="viewcode-back" href="../generated/generated/httplib.HTTPConnection.set_debuglevel.html#httplib.HTTPConnection.set_debuglevel">[docs]</a>    <span class="k">def</span> <span class="nf">set_debuglevel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debuglevel</span> <span class="o">=</span> <span class="n">level</span></div>

<div class="viewcode-block" id="HTTPConnection._tunnel"><a class="viewcode-back" href="../generated/generated/httplib.HTTPConnection._tunnel.html#httplib.HTTPConnection._tunnel">[docs]</a>    <span class="k">def</span> <span class="nf">_tunnel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;CONNECT </span><span class="si">%s</span><span class="s2">:</span><span class="si">%d</span><span class="s2"> HTTP/1.0</span><span class="se">\r\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tunnel_host</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tunnel_port</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">header</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tunnel_headers</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="se">\r\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sock</span><span class="p">,</span> <span class="n">strict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">,</span>
                                       <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_method</span><span class="p">)</span>
        <span class="p">(</span><span class="n">version</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">_read_status</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">version</span> <span class="o">==</span> <span class="s2">&quot;HTTP/0.9&quot;</span><span class="p">:</span>
            <span class="c1"># HTTP/0.9 doesn&#39;t support the CONNECT verb, so if httplib has</span>
            <span class="c1"># concluded HTTP/0.9 is being used something has gone wrong.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">raise</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid response from tunnel request&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">raise</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Tunnel connection failed: </span><span class="si">%d</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">code</span><span class="p">,</span>
                                                                    <span class="n">message</span><span class="o">.</span><span class="n">strip</span><span class="p">()))</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">readline</span><span class="p">(</span><span class="n">_MAXLINE</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">_MAXLINE</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">LineTooLong</span><span class="p">(</span><span class="s2">&quot;header line&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
                <span class="c1"># for sites which EOF without sending trailer</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">:</span>
                <span class="k">break</span></div>


<div class="viewcode-block" id="HTTPConnection.connect"><a class="viewcode-back" href="../generated/generated/httplib.HTTPConnection.connect.html#httplib.HTTPConnection.connect">[docs]</a>    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Connect to the host and port specified in __init__.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sock</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_connection</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">),</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_address</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tunnel_host</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tunnel</span><span class="p">()</span></div>

<div class="viewcode-block" id="HTTPConnection.close"><a class="viewcode-back" href="../generated/generated/httplib.HTTPConnection.close.html#httplib.HTTPConnection.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Close the connection to the HTTP server.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__state</span> <span class="o">=</span> <span class="n">_CS_IDLE</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sock</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sock</span>
            <span class="k">if</span> <span class="n">sock</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sock</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="n">sock</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>   <span class="c1"># close it manually... there may be other refs</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__response</span>
            <span class="k">if</span> <span class="n">response</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__response</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="n">response</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="HTTPConnection.send"><a class="viewcode-back" href="../generated/generated/httplib.HTTPConnection.send.html#httplib.HTTPConnection.send">[docs]</a>    <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send `data&#39; to the server.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sock</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">auto_open</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">NotConnected</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debuglevel</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">print</span> <span class="s2">&quot;send:&quot;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">blocksize</span> <span class="o">=</span> <span class="mi">8192</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="s1">&#39;read&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">array</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debuglevel</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="k">print</span> <span class="s2">&quot;sendIng a read()able&quot;</span>
            <span class="n">datablock</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">blocksize</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">datablock</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sock</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">datablock</span><span class="p">)</span>
                <span class="n">datablock</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">blocksize</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sock</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div>

<div class="viewcode-block" id="HTTPConnection._output"><a class="viewcode-back" href="../generated/generated/httplib.HTTPConnection._output.html#httplib.HTTPConnection._output">[docs]</a>    <span class="k">def</span> <span class="nf">_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a line of output to the current request buffer.</span>

<span class="sd">        Assumes that the line does *not* end with \\r\\n.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></div>

<div class="viewcode-block" id="HTTPConnection._send_output"><a class="viewcode-back" href="../generated/generated/httplib.HTTPConnection._send_output.html#httplib.HTTPConnection._send_output">[docs]</a>    <span class="k">def</span> <span class="nf">_send_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message_body</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send the currently buffered request and clear the buffer.</span>

<span class="sd">        Appends an extra \\r\\n to the buffer.</span>
<span class="sd">        A message_body may be specified, to be appended to the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">)</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[:]</span>
        <span class="c1"># If msg and message_body are sent in a single send() call,</span>
        <span class="c1"># it will avoid performance problems caused by the interaction</span>
        <span class="c1"># between delayed ack and the Nagle algorithm.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">message_body</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="n">message_body</span>
            <span class="n">message_body</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">message_body</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1">#message_body was not a string (i.e. it is a file) and</span>
            <span class="c1">#we must run the risk of Nagle</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">message_body</span><span class="p">)</span></div>

<div class="viewcode-block" id="HTTPConnection.putrequest"><a class="viewcode-back" href="../generated/generated/httplib.HTTPConnection.putrequest.html#httplib.HTTPConnection.putrequest">[docs]</a>    <span class="k">def</span> <span class="nf">putrequest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">skip_host</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">skip_accept_encoding</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a request to the server.</span>

<span class="sd">        `method&#39; specifies an HTTP request method, e.g. &#39;GET&#39;.</span>
<span class="sd">        `url&#39; specifies the object being requested, e.g. &#39;/index.html&#39;.</span>
<span class="sd">        `skip_host&#39; if True does not add automatically a &#39;Host:&#39; header</span>
<span class="sd">        `skip_accept_encoding&#39; if True does not add automatically an</span>
<span class="sd">           &#39;Accept-Encoding:&#39; header</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># if a prior response has been completed, then forget about it.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__response</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__response</span><span class="o">.</span><span class="n">isclosed</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__response</span> <span class="o">=</span> <span class="bp">None</span>


        <span class="c1"># in certain cases, we cannot issue another request on this connection.</span>
        <span class="c1"># this occurs when:</span>
        <span class="c1">#   1) we are in the process of sending a request.   (_CS_REQ_STARTED)</span>
        <span class="c1">#   2) a response to a previous request has signalled that it is going</span>
        <span class="c1">#      to close the connection upon completion.</span>
        <span class="c1">#   3) the headers for the previous response have not been read, thus</span>
        <span class="c1">#      we cannot determine whether point (2) is true.   (_CS_REQ_SENT)</span>
        <span class="c1">#</span>
        <span class="c1"># if there is no prior response, then we can request at will.</span>
        <span class="c1">#</span>
        <span class="c1"># if point (2) is true, then we will have passed the socket to the</span>
        <span class="c1"># response (effectively meaning, &quot;there is no prior response&quot;), and</span>
        <span class="c1"># will open a new one when a new request is made.</span>
        <span class="c1">#</span>
        <span class="c1"># Note: if a prior response exists, then we *can* start a new request.</span>
        <span class="c1">#       We are not allowed to begin fetching the response to this new</span>
        <span class="c1">#       request, however, until that prior response is complete.</span>
        <span class="c1">#</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__state</span> <span class="o">==</span> <span class="n">_CS_IDLE</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__state</span> <span class="o">=</span> <span class="n">_CS_REQ_STARTED</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CannotSendRequest</span><span class="p">()</span>

        <span class="c1"># Save the method we use, we need it later in the response phase</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_method</span> <span class="o">=</span> <span class="n">method</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">url</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span>
        <span class="n">hdr</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_http_vsn_str</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_output</span><span class="p">(</span><span class="n">hdr</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_http_vsn</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
            <span class="c1"># Issue some standard headers for better HTTP/1.1 compliance</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_host</span><span class="p">:</span>
                <span class="c1"># this header is issued *only* for HTTP/1.1</span>
                <span class="c1"># connections. more specifically, this means it is</span>
                <span class="c1"># only issued when the client uses the new</span>
                <span class="c1"># HTTPConnection() class. backwards-compat clients</span>
                <span class="c1"># will be using HTTP/1.0 and those clients may be</span>
                <span class="c1"># issuing this header themselves. we should NOT issue</span>
                <span class="c1"># it twice; some web servers (such as Apache) barf</span>
                <span class="c1"># when they see two Host: headers</span>

                <span class="c1"># If we need a non-standard port,include it in the</span>
                <span class="c1"># header.  If the request is going through a proxy,</span>
                <span class="c1"># but the host of the actual URL, not the host of the</span>
                <span class="c1"># proxy.</span>

                <span class="n">netloc</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="k">if</span> <span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;http&#39;</span><span class="p">):</span>
                    <span class="n">nil</span><span class="p">,</span> <span class="n">netloc</span><span class="p">,</span> <span class="n">nil</span><span class="p">,</span> <span class="n">nil</span><span class="p">,</span> <span class="n">nil</span> <span class="o">=</span> <span class="n">urlsplit</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">netloc</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">netloc_enc</span> <span class="o">=</span> <span class="n">netloc</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">UnicodeEncodeError</span><span class="p">:</span>
                        <span class="n">netloc_enc</span> <span class="o">=</span> <span class="n">netloc</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;idna&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">putheader</span><span class="p">(</span><span class="s1">&#39;Host&#39;</span><span class="p">,</span> <span class="n">netloc_enc</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tunnel_host</span><span class="p">:</span>
                        <span class="n">host</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tunnel_host</span>
                        <span class="n">port</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tunnel_port</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">host</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">host</span>
                        <span class="n">port</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span>

                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">host_enc</span> <span class="o">=</span> <span class="n">host</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">UnicodeEncodeError</span><span class="p">:</span>
                        <span class="n">host_enc</span> <span class="o">=</span> <span class="n">host</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;idna&quot;</span><span class="p">)</span>
                    <span class="c1"># Wrap the IPv6 Host Header with [] (RFC 2732)</span>
                    <span class="k">if</span> <span class="n">host_enc</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">host_enc</span> <span class="o">=</span> <span class="s2">&quot;[&quot;</span> <span class="o">+</span> <span class="n">host_enc</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span>
                    <span class="k">if</span> <span class="n">port</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_port</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">putheader</span><span class="p">(</span><span class="s1">&#39;Host&#39;</span><span class="p">,</span> <span class="n">host_enc</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">putheader</span><span class="p">(</span><span class="s1">&#39;Host&#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">host_enc</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>

            <span class="c1"># note: we are assuming that clients will not attempt to set these</span>
            <span class="c1">#       headers since *this* library must deal with the</span>
            <span class="c1">#       consequences. this also means that when the supporting</span>
            <span class="c1">#       libraries are updated to recognize other forms, then this</span>
            <span class="c1">#       code should be changed (removed or updated).</span>

            <span class="c1"># we only want a Content-Encoding of &quot;identity&quot; since we don&#39;t</span>
            <span class="c1"># support encodings such as x-gzip or x-deflate.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_accept_encoding</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">putheader</span><span class="p">(</span><span class="s1">&#39;Accept-Encoding&#39;</span><span class="p">,</span> <span class="s1">&#39;identity&#39;</span><span class="p">)</span>

            <span class="c1"># we can accept &quot;chunked&quot; Transfer-Encodings, but no others</span>
            <span class="c1"># NOTE: no TE header implies *only* &quot;chunked&quot;</span>
            <span class="c1">#self.putheader(&#39;TE&#39;, &#39;chunked&#39;)</span>

            <span class="c1"># if TE is supplied in the header, then it must appear in a</span>
            <span class="c1"># Connection header.</span>
            <span class="c1">#self.putheader(&#39;Connection&#39;, &#39;TE&#39;)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># For HTTP/1.0, the server will assume &quot;not chunked&quot;</span>
            <span class="k">pass</span></div>

<div class="viewcode-block" id="HTTPConnection.putheader"><a class="viewcode-back" href="../generated/generated/httplib.HTTPConnection.putheader.html#httplib.HTTPConnection.putheader">[docs]</a>    <span class="k">def</span> <span class="nf">putheader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="o">*</span><span class="n">values</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a request header line to the server.</span>

<span class="sd">        For example: h.putheader(&#39;Accept&#39;, &#39;text/html&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__state</span> <span class="o">!=</span> <span class="n">_CS_REQ_STARTED</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CannotSendHeader</span><span class="p">()</span>

        <span class="n">header</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">header</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_is_legal_header_name</span><span class="p">(</span><span class="n">header</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid header name </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">header</span><span class="p">,))</span>

        <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">one_value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">_is_illegal_header_value</span><span class="p">(</span><span class="n">one_value</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid header value </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">one_value</span><span class="p">,))</span>

        <span class="n">hdr</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\r\n\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">values</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_output</span><span class="p">(</span><span class="n">hdr</span><span class="p">)</span></div>

<div class="viewcode-block" id="HTTPConnection.endheaders"><a class="viewcode-back" href="../generated/generated/httplib.HTTPConnection.endheaders.html#httplib.HTTPConnection.endheaders">[docs]</a>    <span class="k">def</span> <span class="nf">endheaders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message_body</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Indicate that the last header line has been sent to the server.</span>

<span class="sd">        This method sends the request to the server.  The optional</span>
<span class="sd">        message_body argument can be used to pass a message body</span>
<span class="sd">        associated with the request.  The message body will be sent in</span>
<span class="sd">        the same packet as the message headers if it is string, otherwise it is</span>
<span class="sd">        sent as a separate packet.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__state</span> <span class="o">==</span> <span class="n">_CS_REQ_STARTED</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__state</span> <span class="o">=</span> <span class="n">_CS_REQ_SENT</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CannotSendHeader</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_output</span><span class="p">(</span><span class="n">message_body</span><span class="p">)</span></div>

<div class="viewcode-block" id="HTTPConnection.request"><a class="viewcode-back" href="../generated/generated/httplib.HTTPConnection.request.html#httplib.HTTPConnection.request">[docs]</a>    <span class="k">def</span> <span class="nf">request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;Send a complete request to the server.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="p">)</span></div>

<div class="viewcode-block" id="HTTPConnection._set_content_length"><a class="viewcode-back" href="../generated/generated/httplib.HTTPConnection._set_content_length.html#httplib.HTTPConnection._set_content_length">[docs]</a>    <span class="k">def</span> <span class="nf">_set_content_length</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
        <span class="c1"># Set the content-length based on the body. If the body is &quot;empty&quot;, we</span>
        <span class="c1"># set Content-Length: 0 for methods that expect a body (RFC 7230,</span>
        <span class="c1"># Section 3.3.2). If the body is set for other methods, we set the</span>
        <span class="c1"># header provided we can figure out what the length is.</span>
        <span class="n">thelen</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="n">body</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="n">_METHODS_EXPECTING_BODY</span><span class="p">:</span>
            <span class="n">thelen</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
        <span class="k">elif</span> <span class="n">body</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">thelen</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">body</span><span class="p">))</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="c1"># If this is a file-like object, try to</span>
                <span class="c1"># fstat its file descriptor</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">thelen</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">fstat</span><span class="p">(</span><span class="n">body</span><span class="o">.</span><span class="n">fileno</span><span class="p">())</span><span class="o">.</span><span class="n">st_size</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">):</span>
                    <span class="c1"># Don&#39;t send a length if this failed</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debuglevel</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="k">print</span> <span class="s2">&quot;Cannot stat!!&quot;</span>

        <span class="k">if</span> <span class="n">thelen</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">putheader</span><span class="p">(</span><span class="s1">&#39;Content-Length&#39;</span><span class="p">,</span> <span class="n">thelen</span><span class="p">)</span></div>

<div class="viewcode-block" id="HTTPConnection._send_request"><a class="viewcode-back" href="../generated/generated/httplib.HTTPConnection._send_request.html#httplib.HTTPConnection._send_request">[docs]</a>    <span class="k">def</span> <span class="nf">_send_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="p">):</span>
        <span class="c1"># Honor explicitly requested Host: and Accept-Encoding: headers.</span>
        <span class="n">header_names</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">([</span><span class="n">k</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">])</span>
        <span class="n">skips</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="s1">&#39;host&#39;</span> <span class="ow">in</span> <span class="n">header_names</span><span class="p">:</span>
            <span class="n">skips</span><span class="p">[</span><span class="s1">&#39;skip_host&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="s1">&#39;accept-encoding&#39;</span> <span class="ow">in</span> <span class="n">header_names</span><span class="p">:</span>
            <span class="n">skips</span><span class="p">[</span><span class="s1">&#39;skip_accept_encoding&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">putrequest</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="o">**</span><span class="n">skips</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;content-length&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">header_names</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_content_length</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">hdr</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">headers</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">putheader</span><span class="p">(</span><span class="n">hdr</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">endheaders</span><span class="p">(</span><span class="n">body</span><span class="p">)</span></div>

<div class="viewcode-block" id="HTTPConnection.getresponse"><a class="viewcode-back" href="../generated/generated/httplib.HTTPConnection.getresponse.html#httplib.HTTPConnection.getresponse">[docs]</a>    <span class="k">def</span> <span class="nf">getresponse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buffering</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="s2">&quot;Get the response from the server.&quot;</span>

        <span class="c1"># if a prior response has been completed, then forget about it.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__response</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__response</span><span class="o">.</span><span class="n">isclosed</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__response</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1">#</span>
        <span class="c1"># if a prior response exists, then it must be completed (otherwise, we</span>
        <span class="c1"># cannot read this response&#39;s header to determine the connection-close</span>
        <span class="c1"># behavior)</span>
        <span class="c1">#</span>
        <span class="c1"># note: if a prior response existed, but was connection-close, then the</span>
        <span class="c1"># socket and response were made independent of this HTTPConnection</span>
        <span class="c1"># object since a new request requires that we open a whole new</span>
        <span class="c1"># connection</span>
        <span class="c1">#</span>
        <span class="c1"># this means the prior response had one of two states:</span>
        <span class="c1">#   1) will_close: this connection was reset and the prior socket and</span>
        <span class="c1">#                  response operate independently</span>
        <span class="c1">#   2) persistent: the response was retained and we await its</span>
        <span class="c1">#                  isclosed() status to become true.</span>
        <span class="c1">#</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__state</span> <span class="o">!=</span> <span class="n">_CS_REQ_SENT</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">__response</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ResponseNotReady</span><span class="p">()</span>

        <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sock</span><span class="p">,)</span>
        <span class="n">kwds</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;strict&quot;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">,</span> <span class="s2">&quot;method&quot;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_method</span><span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debuglevel</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">+=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">debuglevel</span><span class="p">,)</span>
        <span class="k">if</span> <span class="n">buffering</span><span class="p">:</span>
            <span class="c1">#only add this keyword if non-default, for compatibility with</span>
            <span class="c1">#other response_classes.</span>
            <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;buffering&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span><span class="p">;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_class</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span>
            <span class="k">assert</span> <span class="n">response</span><span class="o">.</span><span class="n">will_close</span> <span class="o">!=</span> <span class="n">_UNKNOWN</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__state</span> <span class="o">=</span> <span class="n">_CS_IDLE</span>

            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">will_close</span><span class="p">:</span>
                <span class="c1"># this effectively passes the connection to the response</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># remember this, so we can tell when it is complete</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__response</span> <span class="o">=</span> <span class="n">response</span>

            <span class="k">return</span> <span class="n">response</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">response</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">raise</span></div></div>


<div class="viewcode-block" id="HTTP"><a class="viewcode-back" href="../generated/generated/httplib.HTTP.html#httplib.HTTP">[docs]</a><span class="k">class</span> <span class="nc">HTTP</span><span class="p">:</span>
    <span class="s2">&quot;Compatibility class with httplib.py from 1.5.&quot;</span>

    <span class="n">_http_vsn</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">_http_vsn_str</span> <span class="o">=</span> <span class="s1">&#39;HTTP/1.0&#39;</span>

    <span class="n">debuglevel</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">_connection_class</span> <span class="o">=</span> <span class="n">HTTPConnection</span>

<div class="viewcode-block" id="HTTP.__init__"><a class="viewcode-back" href="../generated/generated/httplib.HTTP.__init__.html#httplib.HTTP.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="s2">&quot;Provide a default host, since the superclass requires one.&quot;</span>

        <span class="c1"># some joker passed 0 explicitly, meaning default port</span>
        <span class="k">if</span> <span class="n">port</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">port</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1"># Note that we may pass an empty string as the host; this will raise</span>
        <span class="c1"># an error when we attempt to connect. Presumably, the client code</span>
        <span class="c1"># will call connect before then, with a proper host.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_connection_class</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">strict</span><span class="p">))</span></div>

<div class="viewcode-block" id="HTTP._setup"><a class="viewcode-back" href="../generated/generated/httplib.HTTP._setup.html#httplib.HTTP._setup">[docs]</a>    <span class="k">def</span> <span class="nf">_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conn</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_conn</span> <span class="o">=</span> <span class="n">conn</span>

        <span class="c1"># set up delegation to flesh out interface</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">send</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">putrequest</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">putrequest</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">putheader</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">putheader</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">endheaders</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">endheaders</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_debuglevel</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">set_debuglevel</span>

        <span class="n">conn</span><span class="o">.</span><span class="n">_http_vsn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_http_vsn</span>
        <span class="n">conn</span><span class="o">.</span><span class="n">_http_vsn_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_http_vsn_str</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="bp">None</span></div>

<div class="viewcode-block" id="HTTP.connect"><a class="viewcode-back" href="../generated/generated/httplib.HTTP.connect.html#httplib.HTTP.connect">[docs]</a>    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="s2">&quot;Accept arguments to set the host/port, since the superclass doesn&#39;t.&quot;</span>

        <span class="k">if</span> <span class="n">host</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_conn</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conn</span><span class="o">.</span><span class="n">port</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conn</span><span class="o">.</span><span class="n">_get_hostport</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_conn</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span></div>

<div class="viewcode-block" id="HTTP.getfile"><a class="viewcode-back" href="../generated/generated/httplib.HTTP.getfile.html#httplib.HTTP.getfile">[docs]</a>    <span class="k">def</span> <span class="nf">getfile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;Provide a getfile, since the superclass&#39; does not use this concept.&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span></div>

<div class="viewcode-block" id="HTTP.getreply"><a class="viewcode-back" href="../generated/generated/httplib.HTTP.getreply.html#httplib.HTTP.getreply">[docs]</a>    <span class="k">def</span> <span class="nf">getreply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buffering</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compat definition since superclass does not define it.</span>

<span class="sd">        Returns a tuple consisting of:</span>
<span class="sd">        - server status code (e.g. &#39;200&#39; if all goes well)</span>
<span class="sd">        - server &quot;reason&quot; corresponding to status code</span>
<span class="sd">        - any RFC822 headers in the response from the server</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">buffering</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conn</span><span class="o">.</span><span class="n">getresponse</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1">#only add this keyword if non-default for compatibility</span>
                <span class="c1">#with other connection classes</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conn</span><span class="o">.</span><span class="n">getresponse</span><span class="p">(</span><span class="n">buffering</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">BadStatusLine</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1">### hmm. if getresponse() ever closes the socket on a bad request,</span>
            <span class="c1">### then we are going to have problems with self.sock</span>

            <span class="c1">### should we keep this behavior? do people use it?</span>
            <span class="c1"># keep the socket open (as a file), and return it</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conn</span><span class="o">.</span><span class="n">sock</span><span class="o">.</span><span class="n">makefile</span><span class="p">(</span><span class="s1">&#39;rb&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

            <span class="c1"># close our socket -- we want to restart after any protocol error</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">line</span><span class="p">,</span> <span class="bp">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">msg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">fp</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">msg</span></div>

<div class="viewcode-block" id="HTTP.close"><a class="viewcode-back" href="../generated/generated/httplib.HTTP.close.html#httplib.HTTP.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c1"># note that self.file == response.fp, which gets closed by the</span>
        <span class="c1"># superclass. just clear the object ref here.</span>
        <span class="c1">### hmm. messy. if status==-1, then self.file is owned by us.</span>
        <span class="c1">### well... we aren&#39;t explicitly closing, but losing this ref will</span>
        <span class="c1">### do it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="bp">None</span></div></div>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">ssl</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="k">else</span><span class="p">:</span>
<div class="viewcode-block" id="HTTPSConnection"><a class="viewcode-back" href="../generated/generated/httplib.HTTPSConnection.html#httplib.HTTPSConnection">[docs]</a>    <span class="k">class</span> <span class="nc">HTTPSConnection</span><span class="p">(</span><span class="n">HTTPConnection</span><span class="p">):</span>
        <span class="s2">&quot;This class allows communication via SSL.&quot;</span>

        <span class="n">default_port</span> <span class="o">=</span> <span class="n">HTTPS_PORT</span>

<div class="viewcode-block" id="HTTPSConnection.__init__"><a class="viewcode-back" href="../generated/generated/httplib.HTTPSConnection.__init__.html#httplib.HTTPSConnection.__init__">[docs]</a>        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">key_file</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">cert_file</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                     <span class="n">strict</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">socket</span><span class="o">.</span><span class="n">_GLOBAL_DEFAULT_TIMEOUT</span><span class="p">,</span>
                     <span class="n">source_address</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
            <span class="n">HTTPConnection</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">strict</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span>
                                    <span class="n">source_address</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">key_file</span> <span class="o">=</span> <span class="n">key_file</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cert_file</span> <span class="o">=</span> <span class="n">cert_file</span>
            <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">_create_default_https_context</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">key_file</span> <span class="ow">or</span> <span class="n">cert_file</span><span class="p">:</span>
                <span class="n">context</span><span class="o">.</span><span class="n">load_cert_chain</span><span class="p">(</span><span class="n">cert_file</span><span class="p">,</span> <span class="n">key_file</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_context</span> <span class="o">=</span> <span class="n">context</span></div>

<div class="viewcode-block" id="HTTPSConnection.connect"><a class="viewcode-back" href="../generated/generated/httplib.HTTPSConnection.connect.html#httplib.HTTPSConnection.connect">[docs]</a>        <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="s2">&quot;Connect to a host on a given (SSL) port.&quot;</span>

            <span class="n">HTTPConnection</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tunnel_host</span><span class="p">:</span>
                <span class="n">server_hostname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tunnel_host</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">server_hostname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">host</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">sock</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sock</span><span class="p">,</span>
                                                  <span class="n">server_hostname</span><span class="o">=</span><span class="n">server_hostname</span><span class="p">)</span></div></div>

    <span class="n">__all__</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;HTTPSConnection&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="HTTPS"><a class="viewcode-back" href="../generated/generated/httplib.HTTPS.html#httplib.HTTPS">[docs]</a>    <span class="k">class</span> <span class="nc">HTTPS</span><span class="p">(</span><span class="n">HTTP</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compatibility with 1.5 httplib interface</span>

<span class="sd">        Python 1.5.2 did not have an HTTPS class, but it defined an</span>
<span class="sd">        interface for sending http requests that is also useful for</span>
<span class="sd">        https.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">_connection_class</span> <span class="o">=</span> <span class="n">HTTPSConnection</span>

<div class="viewcode-block" id="HTTPS.__init__"><a class="viewcode-back" href="../generated/generated/httplib.HTTPS.__init__.html#httplib.HTTPS.__init__">[docs]</a>        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">key_file</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">cert_file</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                     <span class="n">strict</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
            <span class="c1"># provide a default host, pass the X509 cert info</span>

            <span class="c1"># urf. compensate for bad input.</span>
            <span class="k">if</span> <span class="n">port</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">port</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_setup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_connection_class</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">key_file</span><span class="p">,</span>
                                               <span class="n">cert_file</span><span class="p">,</span> <span class="n">strict</span><span class="p">,</span>
                                               <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">))</span>

            <span class="c1"># we never actually use these for anything, but we keep them</span>
            <span class="c1"># here for compatibility with post-1.5.2 CVS.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">key_file</span> <span class="o">=</span> <span class="n">key_file</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cert_file</span> <span class="o">=</span> <span class="n">cert_file</span></div></div>


<div class="viewcode-block" id="FakeSocket"><a class="viewcode-back" href="../generated/httplib.FakeSocket.html#httplib.FakeSocket">[docs]</a>    <span class="k">def</span> <span class="nf">FakeSocket</span> <span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">sslobj</span><span class="p">):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;FakeSocket is deprecated, and won&#39;t be in 3.x.  &quot;</span> <span class="o">+</span>
                      <span class="s2">&quot;Use the result of ssl.wrap_socket() directly instead.&quot;</span><span class="p">,</span>
                      <span class="ne">DeprecationWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sslobj</span></div>


<div class="viewcode-block" id="HTTPException"><a class="viewcode-back" href="../generated/httplib.HTTPException.html#httplib.HTTPException">[docs]</a><span class="k">class</span> <span class="nc">HTTPException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="c1"># Subclasses that define an __init__ must call Exception.__init__</span>
    <span class="c1"># or define self.args.  Otherwise, str() will fail.</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="NotConnected"><a class="viewcode-back" href="../generated/httplib.NotConnected.html#httplib.NotConnected">[docs]</a><span class="k">class</span> <span class="nc">NotConnected</span><span class="p">(</span><span class="n">HTTPException</span><span class="p">):</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="InvalidURL"><a class="viewcode-back" href="../generated/httplib.InvalidURL.html#httplib.InvalidURL">[docs]</a><span class="k">class</span> <span class="nc">InvalidURL</span><span class="p">(</span><span class="n">HTTPException</span><span class="p">):</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="UnknownProtocol"><a class="viewcode-back" href="../generated/httplib.UnknownProtocol.html#httplib.UnknownProtocol">[docs]</a><span class="k">class</span> <span class="nc">UnknownProtocol</span><span class="p">(</span><span class="n">HTTPException</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">version</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">version</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">version</span></div>

<div class="viewcode-block" id="UnknownTransferEncoding"><a class="viewcode-back" href="../generated/httplib.UnknownTransferEncoding.html#httplib.UnknownTransferEncoding">[docs]</a><span class="k">class</span> <span class="nc">UnknownTransferEncoding</span><span class="p">(</span><span class="n">HTTPException</span><span class="p">):</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="UnimplementedFileMode"><a class="viewcode-back" href="../generated/httplib.UnimplementedFileMode.html#httplib.UnimplementedFileMode">[docs]</a><span class="k">class</span> <span class="nc">UnimplementedFileMode</span><span class="p">(</span><span class="n">HTTPException</span><span class="p">):</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="IncompleteRead"><a class="viewcode-back" href="../generated/httplib.IncompleteRead.html#httplib.IncompleteRead">[docs]</a><span class="k">class</span> <span class="nc">IncompleteRead</span><span class="p">(</span><span class="n">HTTPException</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">partial</span><span class="p">,</span> <span class="n">expected</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">partial</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">partial</span> <span class="o">=</span> <span class="n">partial</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expected</span> <span class="o">=</span> <span class="n">expected</span>
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">e</span> <span class="o">=</span> <span class="s1">&#39;, </span><span class="si">%i</span><span class="s1"> more expected&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">e</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">return</span> <span class="s1">&#39;IncompleteRead(</span><span class="si">%i</span><span class="s1"> bytes read</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">partial</span><span class="p">),</span> <span class="n">e</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="ImproperConnectionState"><a class="viewcode-back" href="../generated/httplib.ImproperConnectionState.html#httplib.ImproperConnectionState">[docs]</a><span class="k">class</span> <span class="nc">ImproperConnectionState</span><span class="p">(</span><span class="n">HTTPException</span><span class="p">):</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="CannotSendRequest"><a class="viewcode-back" href="../generated/httplib.CannotSendRequest.html#httplib.CannotSendRequest">[docs]</a><span class="k">class</span> <span class="nc">CannotSendRequest</span><span class="p">(</span><span class="n">ImproperConnectionState</span><span class="p">):</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="CannotSendHeader"><a class="viewcode-back" href="../generated/httplib.CannotSendHeader.html#httplib.CannotSendHeader">[docs]</a><span class="k">class</span> <span class="nc">CannotSendHeader</span><span class="p">(</span><span class="n">ImproperConnectionState</span><span class="p">):</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="ResponseNotReady"><a class="viewcode-back" href="../generated/httplib.ResponseNotReady.html#httplib.ResponseNotReady">[docs]</a><span class="k">class</span> <span class="nc">ResponseNotReady</span><span class="p">(</span><span class="n">ImproperConnectionState</span><span class="p">):</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="BadStatusLine"><a class="viewcode-back" href="../generated/httplib.BadStatusLine.html#httplib.BadStatusLine">[docs]</a><span class="k">class</span> <span class="nc">BadStatusLine</span><span class="p">(</span><span class="n">HTTPException</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">line</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="n">line</span></div>

<div class="viewcode-block" id="LineTooLong"><a class="viewcode-back" href="../generated/httplib.LineTooLong.html#httplib.LineTooLong">[docs]</a><span class="k">class</span> <span class="nc">LineTooLong</span><span class="p">(</span><span class="n">HTTPException</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line_type</span><span class="p">):</span>
        <span class="n">HTTPException</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;got more than </span><span class="si">%d</span><span class="s2"> bytes when reading </span><span class="si">%s</span><span class="s2">&quot;</span>
                                     <span class="o">%</span> <span class="p">(</span><span class="n">_MAXLINE</span><span class="p">,</span> <span class="n">line_type</span><span class="p">))</span></div>

<span class="c1"># for backwards compatibility</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">HTTPException</span>

<div class="viewcode-block" id="LineAndFileWrapper"><a class="viewcode-back" href="../generated/generated/httplib.LineAndFileWrapper.html#httplib.LineAndFileWrapper">[docs]</a><span class="k">class</span> <span class="nc">LineAndFileWrapper</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;A limited file-like object for HTTP/0.9 responses.&quot;&quot;&quot;</span>

    <span class="c1"># The status-line parsing code calls readline(), which normally</span>
    <span class="c1"># get the HTTP status line.  For a 0.9 response, however, this is</span>
    <span class="c1"># actually the first line of the body!  Clients need to get a</span>
    <span class="c1"># readable file object that contains that line.</span>

<div class="viewcode-block" id="LineAndFileWrapper.__init__"><a class="viewcode-back" href="../generated/generated/httplib.LineAndFileWrapper.__init__.html#httplib.LineAndFileWrapper.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="nb">file</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_line</span> <span class="o">=</span> <span class="n">line</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_file</span> <span class="o">=</span> <span class="nb">file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_line_consumed</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_line_offset</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_line_left</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span></div>

<div class="viewcode-block" id="LineAndFileWrapper.__getattr__"><a class="viewcode-back" href="../generated/generated/httplib.LineAndFileWrapper.__getattr__.html#httplib.LineAndFileWrapper.__getattr__">[docs]</a>    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span></div>

<div class="viewcode-block" id="LineAndFileWrapper._done"><a class="viewcode-back" href="../generated/generated/httplib.LineAndFileWrapper._done.html#httplib.LineAndFileWrapper._done">[docs]</a>    <span class="k">def</span> <span class="nf">_done</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># called when the last byte is read from the line.  After the</span>
        <span class="c1"># call, all read methods are delegated to the underlying file</span>
        <span class="c1"># object.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_line_consumed</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">read</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">readline</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readlines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">readlines</span></div>

<div class="viewcode-block" id="LineAndFileWrapper.read"><a class="viewcode-back" href="../generated/generated/httplib.LineAndFileWrapper.read.html#httplib.LineAndFileWrapper.read">[docs]</a>    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amt</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_line_consumed</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">amt</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_line_left</span>
        <span class="k">if</span> <span class="n">amt</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">amt</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_line_left</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_line</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_line_offset</span><span class="p">:]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_done</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">amt</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">s</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">s</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">amt</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">amt</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_line_left</span>
            <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_line_offset</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">amt</span>
            <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_line</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">j</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_line_offset</span> <span class="o">=</span> <span class="n">j</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_line_left</span> <span class="o">-=</span> <span class="n">amt</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_line_left</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_done</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">s</span></div>

<div class="viewcode-block" id="LineAndFileWrapper.readline"><a class="viewcode-back" href="../generated/generated/httplib.LineAndFileWrapper.readline.html#httplib.LineAndFileWrapper.readline">[docs]</a>    <span class="k">def</span> <span class="nf">readline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_line_consumed</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_line_left</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_line</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_line_offset</span><span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_done</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">s</span></div>

<div class="viewcode-block" id="LineAndFileWrapper.readlines"><a class="viewcode-back" href="../generated/generated/httplib.LineAndFileWrapper.readlines.html#httplib.LineAndFileWrapper.readlines">[docs]</a>    <span class="k">def</span> <span class="nf">readlines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_line_consumed</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_line_left</span>
        <span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_line</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_line_offset</span><span class="p">:]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_done</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">L</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">L</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">(</span><span class="n">size</span><span class="p">)</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/copybutton.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>