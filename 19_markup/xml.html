

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5. XML Processing Modules &mdash; Python Standard Library</title>
  

  
  
    <link rel="shortcut icon" href="../_static/py.png"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Python Standard Library" href="../index.html"/>
        <link rel="up" title="19 Structured Markup Processing Tools" href="19.html"/>
        <link rel="next" title="7. xml.etree.ElementTree — The ElementTree XML API" href="xml.etree.elementtree.html"/>
        <link rel="prev" title="3. (depr) htmllib — A parser for HTML documents" href="htmllib.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Python Standard Library
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../01to10.html">Ch 01 - 10</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11to20.html">Ch 11 - 20</a></li>
<li class="toctree-l1"><a class="reference internal" href="../21to30.html">Ch 21 - 30</a></li>
<li class="toctree-l1"><a class="reference internal" href="../31to37.html">Ch 31 - 37</a></li>
</ul>
<p class="caption"><span class="caption-text">Autogenerated API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api_06to10.html">API: 06 - 10</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_11to15.html">API: 11 - 15</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_16to20.html">API: 16 - 20</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_21to25.html">API: 21 - 25</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_26to30.html">API: 26 - 30</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_31to37.html">API: 31 - 37</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Python Standard Library</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          













<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../11to20.html">Ch 11 - 20</a> &raquo;</li>
        
          <li><a href="19.html">19 Structured Markup Processing Tools</a> &raquo;</li>
        
      <li>5. XML Processing Modules</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/19_markup/xml.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-xml">
<span id="xml-processing-modules"></span><span id="xml"></span><h1>5. XML Processing Modules<a class="headerlink" href="#module-xml" title="Permalink to this headline">¶</a></h1>
<p>Python&#8217;s interfaces for processing XML are grouped in the <code class="docutils literal"><span class="pre">xml</span></code> package.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The XML modules are not secure against erroneous or maliciously
constructed data.  If you need to parse untrusted or unauthenticated data see
<a class="reference internal" href="#xml-vulnerabilities"><span>XML vulnerabilities</span></a>.</p>
</div>
<p>It is important to note that modules in the <a class="reference internal" href="../generated/xml.html#module-xml" title="xml"><code class="xref py py-mod docutils literal"><span class="pre">xml</span></code></a> package require that
there be at least one SAX-compliant XML parser available. The Expat parser is
included with Python, so the <a class="reference internal" href="pyexpat.html#module-xml.parsers.expat" title="xml.parsers.expat: An interface to the Expat non-validating XML parser."><code class="xref py py-mod docutils literal"><span class="pre">xml.parsers.expat</span></code></a> module will always be
available.</p>
<p>The documentation for the <a class="reference internal" href="../generated/xml.dom.html#module-xml.dom" title="xml.dom"><code class="xref py py-mod docutils literal"><span class="pre">xml.dom</span></code></a> and <a class="reference internal" href="../generated/xml.sax.html#module-xml.sax" title="xml.sax"><code class="xref py py-mod docutils literal"><span class="pre">xml.sax</span></code></a> packages are the
definition of the Python bindings for the DOM and SAX interfaces.</p>
<p>The XML handling submodules are:</p>
<ul class="simple">
<li><a class="reference internal" href="../generated/xml.etree.ElementTree.html#module-xml.etree.ElementTree" title="xml.etree.ElementTree"><code class="xref py py-mod docutils literal"><span class="pre">xml.etree.ElementTree</span></code></a>: the ElementTree API, a simple and lightweight
XML processor</li>
</ul>
<ul class="simple">
<li><a class="reference internal" href="../generated/xml.dom.html#module-xml.dom" title="xml.dom"><code class="xref py py-mod docutils literal"><span class="pre">xml.dom</span></code></a>: the DOM API definition</li>
<li><a class="reference internal" href="../generated/xml.dom.minidom.html#module-xml.dom.minidom" title="xml.dom.minidom"><code class="xref py py-mod docutils literal"><span class="pre">xml.dom.minidom</span></code></a>: a minimal DOM implementation</li>
<li><a class="reference internal" href="../generated/xml.dom.pulldom.html#module-xml.dom.pulldom" title="xml.dom.pulldom"><code class="xref py py-mod docutils literal"><span class="pre">xml.dom.pulldom</span></code></a>: support for building partial DOM trees</li>
</ul>
<ul class="simple">
<li><a class="reference internal" href="../generated/xml.sax.html#module-xml.sax" title="xml.sax"><code class="xref py py-mod docutils literal"><span class="pre">xml.sax</span></code></a>: SAX2 base classes and convenience functions</li>
<li><a class="reference internal" href="pyexpat.html#module-xml.parsers.expat" title="xml.parsers.expat: An interface to the Expat non-validating XML parser."><code class="xref py py-mod docutils literal"><span class="pre">xml.parsers.expat</span></code></a>: the Expat parser binding</li>
</ul>
</div>
<div class="section" id="xml-vulnerabilities">
<span id="id1"></span><h1>6. XML vulnerabilities<a class="headerlink" href="#xml-vulnerabilities" title="Permalink to this headline">¶</a></h1>
<p>The XML processing modules are not secure against maliciously constructed data.
An attacker can abuse vulnerabilities for e.g. denial of service attacks, to
access local files, to generate network connections to other machines, or
to or circumvent firewalls. The attacks on XML abuse unfamiliar features
like inline <a class="reference external" href="https://en.wikipedia.org/wiki/Document_type_definition">DTD</a> (document type definition) with entities.</p>
<p>The following table gives an overview of the known attacks and if the various
modules are vulnerable to them.</p>
<table border="1" class="docutils">
<colgroup>
<col width="37%" />
<col width="12%" />
<col width="13%" />
<col width="13%" />
<col width="12%" />
<col width="13%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">kind</th>
<th class="head">sax</th>
<th class="head">etree</th>
<th class="head">minidom</th>
<th class="head">pulldom</th>
<th class="head">xmlrpc</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>billion laughs</td>
<td><strong>Yes</strong></td>
<td><strong>Yes</strong></td>
<td><strong>Yes</strong></td>
<td><strong>Yes</strong></td>
<td><strong>Yes</strong></td>
</tr>
<tr class="row-odd"><td>quadratic blowup</td>
<td><strong>Yes</strong></td>
<td><strong>Yes</strong></td>
<td><strong>Yes</strong></td>
<td><strong>Yes</strong></td>
<td><strong>Yes</strong></td>
</tr>
<tr class="row-even"><td>external entity expansion</td>
<td><strong>Yes</strong></td>
<td>No    (1)</td>
<td>No    (2)</td>
<td><strong>Yes</strong></td>
<td>No    (3)</td>
</tr>
<tr class="row-odd"><td><a class="reference external" href="https://en.wikipedia.org/wiki/Document_type_definition">DTD</a> retrieval</td>
<td><strong>Yes</strong></td>
<td>No</td>
<td>No</td>
<td><strong>Yes</strong></td>
<td>No</td>
</tr>
<tr class="row-even"><td>decompression bomb</td>
<td>No</td>
<td>No</td>
<td>No</td>
<td>No</td>
<td><strong>Yes</strong></td>
</tr>
</tbody>
</table>
<ol class="arabic simple">
<li><a class="reference internal" href="../generated/xml.etree.ElementTree.html#module-xml.etree.ElementTree" title="xml.etree.ElementTree"><code class="xref py py-mod docutils literal"><span class="pre">xml.etree.ElementTree</span></code></a> doesn&#8217;t expand external entities and raises a
ParserError when an entity occurs.</li>
<li><a class="reference internal" href="../generated/xml.dom.minidom.html#module-xml.dom.minidom" title="xml.dom.minidom"><code class="xref py py-mod docutils literal"><span class="pre">xml.dom.minidom</span></code></a> doesn&#8217;t expand external entities and simply returns
the unexpanded entity verbatim.</li>
<li><a class="reference internal" href="../generated/xmlrpclib.html#module-xmlrpclib" title="xmlrpclib"><code class="xref py py-mod docutils literal"><span class="pre">xmlrpclib</span></code></a> doesn&#8217;t expand external entities and omits them.</li>
</ol>
<dl class="docutils">
<dt>billion laughs / exponential entity expansion</dt>
<dd>The <a class="reference external" href="https://en.wikipedia.org/wiki/Billion_laughs">Billion Laughs</a> attack &#8211; also known as exponential entity expansion &#8211;
uses multiple levels of nested entities. Each entity refers to another entity
several times, the final entity definition contains a small string. Eventually
the small string is expanded to several gigabytes. The exponential expansion
consumes lots of CPU time, too.</dd>
<dt>quadratic blowup entity expansion</dt>
<dd>A quadratic blowup attack is similar to a <a class="reference external" href="https://en.wikipedia.org/wiki/Billion_laughs">Billion Laughs</a> attack; it abuses
entity expansion, too. Instead of nested entities it repeats one large entity
with a couple of thousand chars over and over again. The attack isn&#8217;t as
efficient as the exponential case but it avoids triggering countermeasures of
parsers against heavily nested entities.</dd>
<dt>external entity expansion</dt>
<dd>Entity declarations can contain more than just text for replacement. They can
also point to external resources by public identifiers or system identifiers.
System identifiers are standard URIs or can refer to local files. The XML
parser retrieves the resource with e.g. HTTP or FTP requests and embeds the
content into the XML document.</dd>
<dt><a class="reference external" href="https://en.wikipedia.org/wiki/Document_type_definition">DTD</a> retrieval</dt>
<dd>Some XML libraries like Python&#8217;s <a class="reference internal" href="../generated/xml.dom.pulldom.html#module-xml.dom.pulldom" title="xml.dom.pulldom"><code class="xref py py-mod docutils literal"><span class="pre">xml.dom.pulldom</span></code></a> retrieve document type
definitions from remote or local locations. The feature has similar
implications as the external entity expansion issue.</dd>
<dt>decompression bomb</dt>
<dd>The issue of decompression bombs (aka <a class="reference external" href="https://en.wikipedia.org/wiki/Zip_bomb">ZIP bomb</a>) apply to all XML libraries
that can parse compressed XML stream like gzipped HTTP streams or LZMA-ed
files. For an attacker it can reduce the amount of transmitted data by three
magnitudes or more.</dd>
</dl>
<p>The documentation of <a class="reference external" href="https://pypi.python.org/pypi/defusedxml/">defusedxml</a> on PyPI has further information about
all known attack vectors with examples and references.</p>
<div class="section" id="defused-packages">
<h2>6.1. defused packages<a class="headerlink" href="#defused-packages" title="Permalink to this headline">¶</a></h2>
<p>These external packages are recommended for any code that parses
untrusted XML data.</p>
<p><a class="reference external" href="https://pypi.python.org/pypi/defusedxml/">defusedxml</a> is a pure Python package with modified subclasses of all stdlib
XML parsers that prevent any potentially malicious operation. The
package also ships with example exploits and extended documentation on more
XML exploits like xpath injection.</p>
<p><a class="reference external" href="https://pypi.python.org/pypi/defusedexpat/">defusedexpat</a> provides a modified libexpat and patched replacement
<a class="reference internal" href="../generated/pyexpat.html#module-pyexpat" title="pyexpat"><code class="xref py py-mod docutils literal"><span class="pre">pyexpat</span></code></a> extension module with countermeasures against entity expansion
DoS attacks. Defusedexpat still allows a sane and configurable amount of entity
expansions. The modifications will be merged into future releases of Python.</p>
<p>The workarounds and modifications are not included in patch releases as they
break backward compatibility. After all inline DTD and entity expansion are
well-defined XML features.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="xml.etree.elementtree.html" class="btn btn-neutral float-right" title="7. xml.etree.ElementTree — The ElementTree XML API" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="htmllib.html" class="btn btn-neutral" title="3. (depr) htmllib — A parser for HTML documents" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/copybutton.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>